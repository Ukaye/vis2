<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Finratus Admin</title>
    <meta name="description" content="Finratus Admin">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="apple-icon.png">
    <link rel="shortcut icon" href="favicon.png">
    <link rel="stylesheet" href="assets/css/normalize.css">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/themify-icons.css">
    <link rel="stylesheet" href="assets/css/flag-icon.min.css">
    <link rel="stylesheet" href="assets/css/cs-skin-elastic.css">
    <link rel="stylesheet" href="assets/css/lib/datatable/dataTables.bootstrap.min.css">
    <link rel="stylesheet" href="assets/scss/style.css">
    <link rel="stylesheet" href="assets/css/lib/chosen/chosen.min.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/css'>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="assets/js/vendor/jquery-2.1.4.min.js"></script>
</head>
<body class="open">
<!-- Left Panel -->
<script src="assets/js/vendor/jquery-2.1.4.min.js"></script>
<script src="../../menus/menu-items.js"></script>
<script type="text/javascript">
//    jQuery(document).ready(function($){ check(); loadMenus(); read_write();});
</script>

<style>
    #regForm {
        background-color: rgba(255, 255, 255, 0.44);
        /*margin: 100px auto;*/
        padding: 20px;
        /*width: 70%;*/
        /*!*min-width: 300px;*!*/
    }

    /* Hide all steps by default: */
    .tab {
        display: none;
    }

    /* Make circles that indicate the steps of the form: */
    .step {
        height: 15px;
        width: 15px;
        margin: 0 2px;
        background-color: #bbbbbb;
        border: none;
        border-radius: 50%;
        display: inline-block;
        opacity: 0.5;
    }

    /* Mark the active step: */
    .step.active {
        opacity: 1;
    }

    /* Mark the steps that are finished and valid: */
    .step.finish {
        background-color: #4CAF50;
    }
    div.dataTables_wrapper div.dataTables_filter{
        float: right;
        margin-right: 15px;
    }
    div.dataTables_length{
        float: left;
    }
    .dt-buttons.btn-group{
        float: right;
    }
    .btn-default{
        color: #fff;
        background-color: #6c757d;
        border-color: #666e76;
    }
</style>

<aside id="left-panel" class="left-panel" include-html="/includes/sidebar.html">
</aside><!-- /#left-panel -->

<!-- Left Panel -->

<!-- Right Panel -->

<div id="right-panel" class="right-panel">

    <!-- Header-->
    <header id="header" class="header" include-html="/includes/header.html">
    </header>

    <!-- Header-->

    <div class="breadcrumbs">
        <div class="col-sm-4">
            <div class="page-header float-left">
                <div class="page-title">
                    <h1>Loan Reports</h1>
                </div>
            </div>
        </div>
        <div class="col-sm-8">
            <div class="page-header float-right">
                <div class="page-title">
                    <ol class="breadcrumb text-right">
                        <li><a href="#">Dashboard</a></li>
                        <li><a href="#">Loan Reports</a></li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <div class="content mt-3">
        <div class="animated fadeIn">

            <div class="row">
                <div class="card col-sm-12">
                    <div class="card-body">
                        <div class="col-sm-12">
                            <div class="card" style="border-color: transparent">
                                <div class="row">
                                    <!--<div class="col-sm-2">-->
                                        <!--<div class="card text-white bg-flat-color-1">-->
                                            <!--<div class="card-body pb-0" style="text-align: center">-->
                                                <!--<h3 id="branch" class="mb-0"></h3>-->
                                                <!--<p class="text-light">Branches</p>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <!--<div class="col-sm-2">-->
                                        <!--<div class="card text-white bg-flat-color-1">-->
                                            <!--<div class="card-body pb-0" style="text-align: center">-->
                                                <!--<h3 id="loan-officers" class="mb-0"></h3>-->
                                                <!--<p class="text-light">Loan Officers</p>-->
                                            <!--</div>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <div class="col-sm-3">
                                        <div class="card text-white bg-flat-color-1">
                                            <div class="card-body pb-0" style="text-align: center">
                                                <h3 id="loans-active" class="mb-0"></h3>
                                                <p class="text-light">Loan(s) Active</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="card text-white bg-flat-color-1">
                                            <div class="card-body pb-0" style="text-align: center">
                                                <h3 id="loan-per" class="mb-0"></h3>
                                                <p class="text-light">Loans Per Loan Officer</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="card text-white bg-flat-color-1">
                                            <div class="card-body pb-0" style="text-align: center">
                                                <h3 id="avg-loan-balance" class="mb-0"></h3>
                                                <p class="text-light">Average Loan Balance</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="card text-white bg-flat-color-1">
                                            <div class="card-body pb-0" style="text-align: center">
                                                <h3 id="avg-loan-disbursed" class="mb-0"></h3>
                                                <p class="text-light">Average Loans Disbursed</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    &nbsp; &nbsp; &nbsp; <button style="float: right;" onclick="refresh()" class="btn btn-default pull-right"><i class="fa fa-refresh"></i> Refresh Cards</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" href="#intelliboard" role="tab" data-toggle="tab">Disbursed Loans Report</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#principal-reports" role="tab" data-toggle="tab">Principal Reports</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#org-reports" role="tab" data-toggle="tab">Interest Reports</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="pvi-received" href="#vrs-reports" role="tab" data-toggle="tab">Principal Received Vs. Interest Received</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#risk-reports" role="tab" data-toggle="tab">Risk Reports</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="payments" href="#fin-reports" role="tab" data-toggle="tab">Payments</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="branches" href="#branch-reports" role="tab" data-toggle="tab">Branch Reports</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="demo" href="#demo-reports" role="tab" data-toggle="tab">Demographic Reports</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="trends" href="#trend-reports" role="tab" data-toggle="tab">Trends</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="export-reports" href="#general-reports" role="tab" data-toggle="tab">General Reports</a>
                                </li>
                            </ul>

                            <!-- Tab panes -->
                            <div class="tab-content">
                                <div role="tabpanel" class="tab-pane fade active show in" id="intelliboard">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="row">
                                                <div id="disbursement-div" class="col-sm-12" >
                                                    <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                        <div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="chartfilterofficers" onchange="dFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="dis-freq" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="disburse-frequency" onchange="dFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="-1"> -- Select Period --</option>
                                                                        <option value="2">Monthly</option>
                                                                        <option value="4">Quarterly</option>
                                                                        <option value="3">Yearly</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="dis-year" style="background-color: transparent; border-color: transparent; display: none">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="disburse-year" onchange="dFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="0">Select Year</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="chart-container" style="text-align: center">FusionCharts XT will load here!</div><hr/>
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <strong role="button" onclick="refreshDisbursements()" >Disbursements &nbsp; &nbsp;&nbsp; &nbsp; <a href="#" title="Click to refresh table"><i class="fa fa-refresh"></i></a></strong>
                                                                <span style="float: right">Total: <span id="total-disbursements"></span></span>
                                                            </div>
                                                            <div class="col-sm-6 card" style="background-color: transparent; border-color: transparent">
                                                                <form id="filterdisbursements" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="startDate" placeholder="Start date">
                                                                    </div>&nbsp;
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="endDate" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                    <div class="input-group">
                                                                        <select id="filter-officers" onchange="filterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <!--<option value="1" selected="selected">All</option>-->
                                                                        <!--<option value="2">Started</option>-->
                                                                        <!--<option value="3">Pending Approval</option>-->
                                                                        <!--<option value="4">Pending Disbursal</option>-->
                                                                        <!--<option value="5">Active</option>-->
                                                                        <!--<option value="6">Closed</option>-->
                                                                        </select>&nbsp;&nbsp;
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="disbursed-table" class="table table-striped table-bordered" width="100%">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Name</th>
                                                                    <th>Principal</th>
                                                                    <!--<th>Balance</th>-->
                                                                    <th>Date Disbursed</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div>
                                                <!--<div id="rescheduled-div" class="col-sm-12" style="display: none">-->
                                                    <!--<div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">-->
                                                        <!--<div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">-->
                                                            <!--<div class="form-group">-->
                                                                <!--<div class="input-group">-->
                                                                    <!--<select id="chartfilterofficers" onchange="dFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">-->
                                                                    <!--</select>-->
                                                                <!--</div>-->
                                                            <!--</div>-->
                                                        <!--</div>-->
                                                        <!--<div class="col-sm-4 card" id="dis-freq" style="background-color: transparent; border-color: transparent">-->
                                                            <!--<div class="form-group">-->
                                                                <!--<div class="input-group">-->
                                                                    <!--<select id="disburse-frequency" onchange="dFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">-->
                                                                        <!--<option value="-1"> &#45;&#45; Select Period &#45;&#45;</option>-->
                                                                        <!--<option value="2">Monthly</option>-->
                                                                        <!--<option value="4">Quarterly</option>-->
                                                                        <!--<option value="3">Yearly</option>-->
                                                                    <!--</select>-->
                                                                <!--</div>-->
                                                            <!--</div>-->
                                                        <!--</div>-->
                                                        <!--<div class="col-sm-4 card" id="dis-year" style="background-color: transparent; border-color: transparent; display: none">-->
                                                            <!--<div class="form-group">-->
                                                                <!--<div class="input-group">-->
                                                                    <!--<select id="disburse-year" onchange="dFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">-->
                                                                        <!--<option value="0">Select Year</option>-->
                                                                    <!--</select>-->
                                                                <!--</div>-->
                                                            <!--</div>-->
                                                        <!--</div>-->
                                                    <!--</div>-->
                                                    <!--<div id="chart-container" style="text-align: center">FusionCharts XT will load here!</div><hr/>-->
                                                    <!--<div class="card">-->
                                                        <!--<div class="card-header">-->
                                                            <!--<div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">-->
                                                                <!--<strong>Disbursements</strong>-->
                                                                <!--<span style="float: right">Total: <span id="total-disbursements"></span></span>-->
                                                            <!--</div>-->
                                                            <!--<div class="col-sm-6 card" style="background-color: transparent; border-color: transparent">-->
                                                                <!--<form id="filterdisbursements" class="form-inline" style="float: right;">-->
                                                                    <!--<div class="form-group">-->
                                                                        <!--<label class="" for="startDate">Start date</label>-->
                                                                        <!--<input type="date" class="form-control" id="startDate" placeholder="Start date">-->
                                                                    <!--</div>&nbsp;-->
                                                                    <!--<div class="form-group">-->
                                                                        <!--<label class="" for="endDate">End date</label>-->
                                                                        <!--<input type="date" class="form-control" id="endDate" placeholder="End date">-->
                                                                    <!--</div>-->
                                                                    <!--<button type="submit" class="btn btn-success">Filter</button>-->
                                                                <!--</form>-->
                                                            <!--</div>-->
                                                            <!--<div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">-->
                                                                <!--<div class="form-group">-->
                                                                    <!--<div class="input-group">-->
                                                                        <!--<select id="filter-officers" onchange="filterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">-->
                                                                            <!--&lt;!&ndash;<option value="1" selected="selected">All</option>&ndash;&gt;-->
                                                                            <!--&lt;!&ndash;<option value="2">Started</option>&ndash;&gt;-->
                                                                            <!--&lt;!&ndash;<option value="3">Pending Approval</option>&ndash;&gt;-->
                                                                            <!--&lt;!&ndash;<option value="4">Pending Disbursal</option>&ndash;&gt;-->
                                                                            <!--&lt;!&ndash;<option value="5">Active</option>&ndash;&gt;-->
                                                                            <!--&lt;!&ndash;<option value="6">Closed</option>&ndash;&gt;-->
                                                                        <!--</select>-->
                                                                    <!--</div>-->
                                                                <!--</div>-->
                                                            <!--</div>-->
                                                        <!--</div>-->
                                                        <!--<div class="card-body">-->
                                                            <!--<table id="disbursed-table" class="table table-striped table-bordered" width="100%">-->
                                                                <!--<thead>-->
                                                                <!--<tr>-->
                                                                    <!--<th>Loan ID</th>-->
                                                                    <!--<th>Name</th>-->
                                                                    <!--<th>Principal</th>-->
                                                                    <!--<th>Balance</th>-->
                                                                    <!--<th>Date Disbursed</th>-->
                                                                <!--</tr>-->
                                                                <!--</thead>-->
                                                                <!--<tbody></tbody>-->
                                                            <!--</table>-->
                                                        <!--</div>-->
                                                    <!--</div>-->
                                                <!--</div>-->
                                                </div>
                                                <div>
                                                <!--<div id="loan-by-branch-div" style="display: none" >-->
                                                    <!--<div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">-->
                                                        <!--<div class="col-sm-2 card" style="background-color: transparent; border-color: transparent">-->
                                                            <!--<div class="form-group">-->
                                                                <!--<div class="input-group">-->
                                                                    <!--<select id="reportview" onchange="changeview(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">-->
                                                                        <!--<option value="1">Single Chart</option>-->
                                                                        <!--<option value="2">Comparison Chart</option>-->
                                                                    <!--</select>-->
                                                                <!--</div>-->
                                                            <!--</div>-->
                                                        <!--</div>-->
                                                        <!--<div class="col-sm-2 card" style="background-color: transparent; border-color: transparent">-->
                                                            <!--<div class="form-group">-->
                                                                <!--<div class="input-group">-->
                                                                    <!--<select id="branchreport" onchange="changereport(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">-->
                                                                        <!--<option value="1">Disbursements</option>-->
                                                                        <!--<option value="2">Interests</option>-->
                                                                    <!--</select>-->
                                                                <!--</div>-->
                                                            <!--</div>-->
                                                        <!--</div>-->
                                                        <!--<div class="col-sm-3 card" id="sel-brn" style="background-color: transparent; border-color: transparent">-->
                                                            <!--<div class="form-group">-->
                                                                <!--<div class="input-group">-->
                                                                    <!--<select id="chartfilterbranches" onchange="bFilterBranch(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">-->
                                                                    <!--</select>-->
                                                                <!--</div>-->
                                                            <!--</div>-->
                                                        <!--</div>-->
                                                        <!--<div class="col-sm-2 card" id="brn-freq" style="background-color: transparent; border-color: transparent">-->
                                                            <!--<div class="form-group">-->
                                                                <!--<div class="input-group">-->
                                                                    <!--<select id="branch-frequency" onchange="bFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">-->
                                                                        <!--<option value="-1"> &#45;&#45; Select Period &#45;&#45;</option>-->
                                                                        <!--<option value="2">Monthly</option>-->
                                                                        <!--<option value="4">Quarterly</option>-->
                                                                        <!--<option value="3">Yearly</option>-->
                                                                    <!--</select>-->
                                                                <!--</div>-->
                                                            <!--</div>-->
                                                        <!--</div>-->
                                                        <!--<div class="col-sm-3 card" id="brn-year" style="background-color: transparent; border-color: transparent; display: none">-->
                                                            <!--<div class="form-group">-->
                                                                <!--<div class="input-group">-->
                                                                    <!--<select id="branch-year" onchange="bFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">-->
                                                                        <!--<option value="0">Select Year</option>-->
                                                                    <!--</select>-->
                                                                <!--</div>-->
                                                            <!--</div>-->
                                                        <!--</div>-->
                                                    <!--</div>-->
                                                    <!--<div id="branch-chart" style="text-align: center">FusionCharts XT will load here!</div><hr/>-->
                                                    <!--<div class="card">-->
                                                        <!--<div class="card-header">-->
                                                            <!--<div class="col-sm-5">-->
                                                                <!--<strong>Loans by Branch</strong>&nbsp;&nbsp;&nbsp;-->
                                                                <!--<span>Total: <span id="total-loans-by-branch"></span></span>-->
                                                            <!--</div>-->
                                                            <!--<div class="col-sm-7">-->
                                                                <!--<form id="filterbybranch" class="form-inline" style="float: right;">-->
                                                                <!--<div class="form-group">-->
                                                                    <!--<label class="" for="startDate">Start date</label>-->
                                                                    <!--<input type="date" class="form-control" id="filterbranchstart" placeholder="Start date">-->
                                                                <!--</div>-->
                                                                <!--<div class="form-group">-->
                                                                    <!--<label class="" for="endDate">End date</label>-->
                                                                    <!--<input type="date" class="form-control" id="filterbranchend" placeholder="End date">-->
                                                                <!--</div>-->
                                                                <!--<button type="submit" class="btn btn-success">Filter</button>-->
                                                            <!--</form>-->
                                                            <!--</div>-->
                                                            <!--&lt;!&ndash;<select id="branch-filter" onchange="filterBranch(this)" style="width: 200px">&ndash;&gt;-->
                                                            <!--&lt;!&ndash;</select>&ndash;&gt;-->
                                                        <!--</div>-->
                                                        <!--<div class="card-body">-->
                                                            <!--<table id="loan-by-branch-table" class="table table-striped table-bordered">-->
                                                                <!--<thead>-->
                                                                <!--<tr>-->
                                                                    <!--<th>Branch ID</th>-->
                                                                    <!--<th>Branch Name</th>-->
                                                                    <!--<th>Disbursed</th>-->
                                                                    <!--<th>Collected</th>-->
                                                                    <!--<th>GLP</th>-->
                                                                <!--</tr>-->
                                                                <!--</thead>-->
                                                                <!--<tbody></tbody>-->
                                                            <!--</table>-->
                                                        <!--</div>-->
                                                    <!--</div>-->
                                                <!--</div>-->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="principal-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="col-sm-12" style="padding: 20px">
                                                <div class="row" style="padding-bottom: 10px">
                                                    <div class="col-sm-6">
                                                        <button id="principal-received-button" class="btn btn-block col-sm-12">Principal Received</button>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <button id="principal-receivable-button" class="btn col-sm-12">Principal Receivable</button>
                                                    </div>
                                                </div>
                                                <!--<div class="row" style="padding-bottom: 10px">-->
                                                    <!--<div class="col-sm-12">-->
                                                        <!--<button id="compare-principals-button" class="btn btn-block col-sm-12">Principal Received&nbsp;&nbsp; &nbsp;Vs. &nbsp;&nbsp;Principal Receivable</button>-->
                                                    <!--</div>-->
                                                <!--</div>-->
                                            </div>
                                            <div class="col-sm-12">
                                                <div id="principal-received-div" style="display: none" class="col-sm-12">
                                                    <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                        <div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="prchartfilterofficers" onchange="prFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="pr-freq" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="pr-frequency" onchange="prFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="-1"> -- Select Period --</option>
                                                                        <option value="2">Monthly</option>
                                                                        <option value="4">Quarterly</option>
                                                                        <option value="3">Yearly</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="pr-year" style="display: none; background-color: transparent; border-color: transparent; ">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="p-r-year" onchange="prFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="0">Select Year</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="principal-received-chart" style="text-align: center">FusionCharts XT will load here!</div><hr/>
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <strong>Principal Received</strong>
                                                                <span>Total: <span id="total-principal-earned"></span></span>
                                                            </div>
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                    <div class="input-group">
                                                                        <select id="principal-officers" onchange="principalFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-6 card" style="background-color: transparent; border-color: transparent">
                                                                <form id="filterprincipal" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filterprincipalstart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filterprincipalend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="principal-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Client Name</th>
                                                                    <th>Principal Received</th>
                                                                    <th>Loan Officer</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="principal-receivable-div" style="display: none" class="col-sm-12">
                                                    <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                        <div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="prrecchartfilterofficers" onchange="prRecFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="pr-rec-freq" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="pr-rec-frequency" onchange="prRecFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="-1"> -- Select Period --</option>
                                                                        <option value="2">Monthly</option>
                                                                        <option value="4">Quarterly</option>
                                                                        <option value="3">Yearly</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="pr-rec-year" style="display: none; background-color: transparent; border-color: transparent; ">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="p-r-rec-year" onchange="prRecFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="0">Select Year</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="principal-receivable-chart" style="text-align: center">FusionCharts XT will load here!</div><hr/>
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <strong>Principal Receivable</strong>
                                                                <span>Total: <span id="total-principal-rec"></span></span>
                                                            </div>
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                    <div class="input-group">
                                                                        <select id="principal-rec-officers" onchange="principalRecFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-6 card" style="background-color: transparent; border-color: transparent">
                                                                <form id="filterprincipalrec" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filterprincipalrecstart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filterprincipalrecend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="principal-rec-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Client Name</th>
                                                                    <th>Principal Receivable</th>
                                                                    <th>Loan Officer</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="org-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="col-sm-12" style="padding: 20px">
                                                <div class="row" style="padding-bottom: 10px">
                                                    <div class="col-sm-6">
                                                        <button id="gross-projected-interest-button" class="btn btn-block col-sm-12">Projected Interest</button>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <button id="interest-receivable-button" class="btn col-sm-12">Interest Receivable</button>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <button id="interests-received-button" class="btn btn-block col-sm-12">Interest Received</button>
                                                    </div>
                                                </div>
                                                <!--<div class="row">-->
                                                <!--</div>-->
                                            </div>
                                            <div class="col-sm-12">
                                                <div id="agg-prj-int-div" style="display: none">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-5">
                                                                <strong>Projected Interests: </strong>
                                                                <span id="agg-interests"></span>
                                                            </div>
                                                            <div class="col-sm-7">
                                                                <form id="filteraggprojectedinterest" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filteraggprointstart" name="filteraggprointstart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filteraggprointend" name="filteraggprointend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <div class="col-sm-3"></div>
                                                            <div class="col-sm-6">
                                                                <div class="card text-white bg-flat-color-4">
                                                                    <div class="card-body pb-0" style="text-align: center">
                                                                        <h3 id="total-projected-interest" class="mb-0"></h3>
                                                                        <p class="text-light"></p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-3"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="interests-received-div" style="display: none" class="col-sm-12">
                                                    <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                        <div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="irchartfilterofficers" onchange="irFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="ir-freq" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="ir-frequency" onchange="irFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="-1"> -- Select Period --</option>
                                                                        <option value="2">Monthly</option>
                                                                        <option value="4">Quarterly</option>
                                                                        <option value="3">Yearly</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="ir-year" style="display: none; background-color: transparent; border-color: transparent; ">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="i-r-year" onchange="irFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="0">Select Year</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="interest-received-chart" style="text-align: center">FusionCharts XT will load here!</div><hr/>
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <strong>Interests Received</strong>
                                                                <span>Total: <span id="total-interests-earned"></span></span>
                                                            </div>
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                    <div class="input-group">
                                                                        <select id="interest-officers" onchange="intFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-6 card" style="background-color: transparent; border-color: transparent">
                                                                <form id="filterinterests" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filterintereststart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filterinterestend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="interests-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Client Name</th>
                                                                    <th>Interest Received</th>
                                                                    <th>Loan Officer</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="interests-receivable-div" style="display: none" class="col-sm-12">
                                                    <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                        <div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="irrecchartfilterofficers" onchange="irRecFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="ir-rec-freq" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="ir-rec-frequency" onchange="irRecFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="-1"> -- Select Period --</option>
                                                                        <option value="2">Monthly</option>
                                                                        <option value="4">Quarterly</option>
                                                                        <option value="3">Yearly</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="ir-rec-year" style="display: none; background-color: transparent; border-color: transparent; ">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="i-r-rec-year" onchange="irRecFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="0">Select Year</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="interest-receivable-chart" style="text-align: center">FusionCharts XT will load here!</div><hr/>
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <strong>Interests Receivable</strong>
                                                                <span>Total: <span id="total-interests-rec"></span></span>
                                                            </div>
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                    <div class="input-group">
                                                                        <select id="interest-rec-officers" onchange="intRecFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-6 card" style="background-color: transparent; border-color: transparent">
                                                                <form id="filterinterestsrec" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filterinterestrecstart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filterinterestrecend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="interests-rec-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Client Name</th>
                                                                    <th>Interest Receivable</th>
                                                                    <th>Loan Officer</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div><!--<div class="col-sm-12">-->
                                                <!--<div id="projected-interests-div" style="display: none" class="col-sm-6">-->
                                                    <!--<div class="card">-->
                                                        <!--<div class="card-header">-->
                                                            <!--<div class="col-sm-5">-->
                                                                <!--<strong>Projected Interest</strong>-->
                                                                <!--<span >Total: <span id="total-interests"></span></span>-->
                                                            <!--</div>-->
                                                            <!--<div class="col-sm-7">-->
                                                                <!--<form id="filterprojectedinterest" class="form-inline" style="float: right;">-->
                                                                    <!--<div class="form-group">-->
                                                                        <!--<label class="" for="startDate">Start date</label>-->
                                                                        <!--<input type="date" class="form-control" id="filterprointstart" placeholder="Start date">-->
                                                                    <!--</div>-->
                                                                    <!--<div class="form-group">-->
                                                                        <!--<label class="" for="endDate">End date</label>-->
                                                                        <!--<input type="date" class="form-control" id="filterprointend" placeholder="End date">-->
                                                                    <!--</div>-->
                                                                    <!--<button type="submit" class="btn btn-success">Filter</button>-->
                                                                <!--</form>-->
                                                            <!--</div>-->
                                                        <!--</div>-->
                                                        <!--<div class="card-body">-->
                                                            <!--<table id="projected-interests-table" class="table table-striped table-bordered">-->
                                                                <!--<thead>-->
                                                                <!--<tr>-->
                                                                    <!--<th>Client ID</th>-->
                                                                    <!--<th>Name</th>-->
                                                                    <!--<th>Projected Interest</th>-->
                                                                <!--</tr>-->
                                                                <!--</thead>-->
                                                                <!--<tbody></tbody>-->
                                                            <!--</table>-->
                                                        <!--</div>-->
                                                    <!--</div>-->
                                                <!--</div>-->
                                            <!--</div>--></div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="vrs-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <!--<div class="col-sm-12" style="padding: 20px">-->
                                                <!--<div class="row" style="padding-bottom: 10px">-->
                                                    <!--<div class="col-sm-6">-->
                                                        <!--<button id="pvi-received" class="btn btn-block col-sm-12">Received</button>-->
                                                    <!--</div>-->
                                                    <!--<div class="col-sm-6">-->
                                                        <!--<button id="pvi-receivable" class="btn col-sm-12">Receivable</button>-->
                                                    <!--</div>-->
                                                <!--</div>-->
                                            <!--</div>-->
                                            <div id="" class="col-sm-12">
                                                <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                    <div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">
                                                        <div class="form-group">
                                                            <div class="input-group">
                                                                <select id="pvifilterofficers" onchange="pviFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-4 card" id="pvi-freq" style="background-color: transparent; border-color: transparent">
                                                        <div class="form-group">
                                                            <div class="input-group">
                                                                <select id="pvi-frequency" onchange="pviFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    <option value="-1"> -- Select Period --</option>
                                                                    <option value="2">Monthly</option>
                                                                    <option value="4">Quarterly</option>
                                                                    <option value="3">Yearly</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-4 card" id="pvi-yr" style="background-color: transparent; border-color: transparent; display: none">
                                                        <div class="form-group">
                                                            <div class="input-group">
                                                                <select id="pvi-year" onchange="pviFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    <option value="0">Select Year</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="vrs-chart" style="text-align: center">Charts will load here!</div><hr/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="risk-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="col-sm-12" style="padding: 20px">
                                                <div class="row" style="padding-bottom: 10px">
                                                    <div class="col-sm-6">
                                                        <button id="overdue-loans-button" class="btn col-sm-12">Overdue Loans</button>
                                                        </div>
                                                    <div class="col-sm-6">
                                                            <button id="bad-loans-button" class="btn btn-block col-sm-12">Bad Loans </button>
                                                        </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <button id="glp-button" class="btn btn-block col-sm-12">Gross Loan Portfolio</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-12">
                                                <div id="bad-loans-div" style="display: none" class="col-sm-6">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-5">
                                                                <strong>Bad Loans</strong>
                                                                <span >Total: <span id="total-badloans"></span></span>
                                                            </div>
                                                            <div class="col-sm-4">
                                                                <!--<form id="filterbadloans" class="form-inline" style="float: right;">-->
                                                                    <!--<div class="form-group">-->
                                                                        <!--<label class="" for="startDate">Start date</label>-->
                                                                        <!--<input type="date" class="form-control" id="filterbadloanstart" placeholder="Start date">-->
                                                                    <!--</div>-->
                                                                    <!--<div class="form-group">-->
                                                                        <!--<label class="" for="endDate">End date</label>-->
                                                                        <!--<input type="date" class="form-control" id="filterbadloanend" placeholder="End date">-->
                                                                    <!--</div>-->
                                                                    <!--<button type="submit" class="btn btn-success">Filter</button>-->
                                                                <!--</form>-->
                                                            </div>
                                                            <div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                    <div class="input-group">
                                                                        <select id="loan-classes" onchange="loanclassFilter(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                    <div class="input-group">
                                                                        <select id="badloans-officers" onchange="blfilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="bad-loans-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Client Name</th>
                                                                    <th>Principal </th>
                                                                    <th>Principal Due</th>
                                                                    <th>Due Date</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="overdue-loans-div" style="display: none" class="col-sm-6">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-3">
                                                                <strong>Overdue Loans</strong>
                                                                <span >Total: <span id="total-overdue"></span></span>
                                                            </div>
                                                            <div class="col-sm-6">
                                                                <form id="filteroverdueloans" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filteroverduestart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filteroverdueend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                            <div class="col-sm-3" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                    <div class="input-group">
                                                                        <select id="overdue-officers" onchange="odfilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="overdues-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Client Name</th>
                                                                    <th>Principal</th>
                                                                    <th>Principal Due</th>
                                                                    <th>Interest Due</th>
                                                                    <th>Date Due</th>
                                                                    <th>Days Since Due</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-12">
                                                <div id="glp-div" style="display: none" class="col-sm-6">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-2" style="background-color: transparent; border-color: transparent">
                                                                <strong>Total GLP: </strong>
                                                                <span id="glp"></span>
                                                            </div>
                                                            <div class="col-sm-7" style="background-color: transparent; border-color: transparent">
                                                                <form id="filterglp" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="startGLPDate" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="endGLPDate" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                            <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                                <div class="form-group">
                                                                    <div class="input-group">
                                                                        <select id="filter-glp-officers" onchange="filterglpOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="glp-table" class="table table-striped table-bordered" width="100%">
                                                                <thead>
                                                                <tr>
                                                                    <th>Loan ID</th>
                                                                    <th>Name</th>
                                                                    <th>Principal</th>
                                                                    <th>Balance</th>
                                                                    <th>Date Disbursed</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="fin-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                        <div class="col-sm-4 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="pchartfilterofficers" onchange="pFilterOfficer(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="pay-freq" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="payment-frequency" onchange="pFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="-1"> -- Select Period --</option>
                                                                        <option value="2">Monthly</option>
                                                                        <option value="4">Quarterly</option>
                                                                        <option value="3">Yearly</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 card" id="pay-year" style="display: none; background-color: transparent; border-color: transparent; ">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="payment-year" onchange="pFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="0">Select Year</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="payments-chart" style="text-align: center">FusionCharts XT will load here!</div><hr/>
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <strong>Payments</strong>
                                                            <form id="filterpayments" class="form-inline" style="float: right;">
                                                                <div class="form-group">
                                                                    <label class="" for="startDate">Start date</label>
                                                                    <input type="date" class="form-control" id="paystart" placeholder="Start date">
                                                                </div>
                                                                <div class="form-group">
                                                                    <label class="" for="endDate">End date</label>
                                                                    <input type="date" class="form-control" id="payend" placeholder="End date">
                                                                </div>
                                                                <button type="submit" class="btn btn-success">Filter</button>
                                                            </form>
                                                            <span style="float: inherit">Total: <span id="total-payments" ></span></span>
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="payments-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Client ID</th>
                                                                    <th>Name</th>
                                                                    <th>Paid (Principal + Interest)</th>
                                                                    <th>Last Payment</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="branch-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="row">
                                                <div id="loan-by-branch-div" class="col-sm-12">
                                                    <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                        <div class="col-sm-2 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="reportview" onchange="changeview(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="1">Single Chart</option>
                                                                        <option value="2">Comparison Chart</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-2 card" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="branchreport" onchange="changereport(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="1">Disbursements</option>
                                                                        <option value="2">Interests</option>
                                                                        <option value="3">Payments</option>
                                                                        <option value="4">Bad Loans</option>
                                                                        <!--<option value="5">Overdues</option>-->
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-3 card" id="sel-brn" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="chartfilterbranches" onchange="bFilterBranch(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-2 card" id="brn-freq" style="background-color: transparent; border-color: transparent">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="branch-frequency" onchange="bFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="-1"> -- Select Period --</option>
                                                                        <option value="2">Monthly</option>
                                                                        <option value="4">Quarterly</option>
                                                                        <option value="3">Yearly</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-3 card" id="brn-year" style="background-color: transparent; border-color: transparent; display: none">
                                                            <div class="form-group">
                                                                <div class="input-group">
                                                                    <select id="branch-year" onchange="bFilterYear(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                        <option value="0">Select Year</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="branch-chart" style="text-align: center">FusionCharts XT will load here!</div><hr/>
                                                    <div id="div-disbursement" class="card">
                                                        <div class="card-header">
                                                            <div class="col-sm-5">
                                                                <strong>Disbursements by Branch</strong>&nbsp;&nbsp;&nbsp;
                                                                <span>Total: <span id="total-loans-by-branch"></span></span>
                                                            </div>
                                                            <div class="col-sm-7">
                                                                <form id="filterbybranch" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filterbranchstart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filterbranchend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                            <!--<select id="branch-filter" onchange="filterBranch(this)" style="width: 200px">-->
                                                            <!--</select>-->
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="loan-by-branch-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Branch ID</th>
                                                                    <th>Branch Name</th>
                                                                    <th>Disbursed</th>
                                                                    <th>Collected</th>
                                                                    <th>GLP</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div id="div-interest" class="card" style="display: none">
                                                        <div class="card-header">
                                                            <div class="col-sm-5">
                                                                <strong>Interests by Branch</strong>&nbsp;&nbsp;&nbsp;
                                                                <span>Total: <span id="total-interest-by-branch"></span></span>
                                                            </div>
                                                            <div class="col-sm-7">
                                                                <form id="filterinterestbybranch" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filterinterestbranchstart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filterinterestbranchend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                            <!--<select id="branch-filter" onchange="filterBranch(this)" style="width: 200px">-->
                                                            <!--</select>-->
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="interest-by-branch-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Branch ID</th>
                                                                    <th>Branch Name</th>
                                                                    <th>Interest Expected</th>
                                                                    <th>Interest Collected</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div id="div-payment" class="card" style="display: none">
                                                        <div class="card-header">
                                                            <div class="col-sm-5">
                                                                <strong>Payments by Branch</strong>&nbsp;&nbsp;&nbsp;
                                                                <span>Total: <span id="total-payments-by-branch"></span></span>
                                                            </div>
                                                            <div class="col-sm-7">
                                                                <form id="filterpaymentsbybranch" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filterpaymentsbranchstart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filterpaymentsbranchend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                            <!--<select id="branch-filter" onchange="filterBranch(this)" style="width: 200px">-->
                                                            <!--</select>-->
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="payments-by-branch-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Branch ID</th>
                                                                    <th>Branch Name</th>
                                                                    <th>Payments Expected (Principal)</th>
                                                                    <th>Payments Received</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div id="div-badloan" class="card" style="display: none">
                                                        <div class="card-header">
                                                            <div class="col-sm-5">
                                                                <strong>Payments by Branch</strong>&nbsp;&nbsp;&nbsp;
                                                                <span>Total: <span id="total-badloans-by-branch"></span></span>
                                                            </div>
                                                            <div class="col-sm-7">
                                                                <form id="filterbadloansbybranch" class="form-inline" style="float: right;">
                                                                    <div class="form-group">
                                                                        <label class="" for="startDate">Start date</label>
                                                                        <input type="date" class="form-control" id="filterbadloanssbranchstart" placeholder="Start date">
                                                                    </div>
                                                                    <div class="form-group">
                                                                        <label class="" for="endDate">End date</label>
                                                                        <input type="date" class="form-control" id="filterbadloansbranchend" placeholder="End date">
                                                                    </div>
                                                                    <button type="submit" class="btn btn-success">Filter</button>
                                                                </form>
                                                            </div>
                                                            <!--<select id="branch-filter" onchange="filterBranch(this)" style="width: 200px">-->
                                                            <!--</select>-->
                                                        </div>
                                                        <div class="card-body">
                                                            <table id="badloans-by-branch-table" class="table table-striped table-bordered">
                                                                <thead>
                                                                <tr>
                                                                    <th>Branch ID</th>
                                                                    <th>Branch Name</th>
                                                                    <th>Bad - Loans Debt</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="demo-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="col-sm-12">
                                                <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                    <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                        <div class="form-group">
                                                            <div class="input-group">
                                                                <select id="demo-report" onchange="demoReportChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    <option id="-1">Choose a report</option>
                                                                    <option id="Interest">Interest</option>
                                                                    <option id="Bad Loans">Bad Loans</option>
                                                                    <option id="Overdue Loans">Overdue Loans</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <div class="form-group">
                                                            <div class="input-group">
                                                                <select id="demo-filter" onchange="demoFilterChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    <option id="-1">Select Filter</option>
                                                                    <option id="Age">Age</option>
                                                                    <option id="Gender">Gender</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <div class="form-group">
                                                            <div class="input-group">
                                                                <select id="demo-frequency" onchange="demoFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    <option value="-1">-- Select Period --</option>
                                                                    <option value="1">Q1</option>
                                                                    <option value="2">Q2</option>
                                                                    <option value="3">Q3</option>
                                                                    <option value="4">Q4</option>
                                                                    <!--<option id="young-adults">18 - 35</option>-->
                                                                    <!--<option id="middle-aged">35 - 50</option>-->
                                                                    <!--<option id="older-adults">50 and older</option>-->
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <div class="form-group">
                                                            <div class="input-group">
                                                                <select id="demo-year" onchange="demoYearChange(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    <option value="0">Select Year</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="interest-demo-chart" style="text-align: center; display: none"></div><hr/>
                                                <div id="badloan-demo-chart" style="text-align: center; display: none"></div><hr/>
                                                <div id="overdue-demo-chart" style="text-align: center; display: none"></div><hr/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="trend-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="col-sm-12">
                                                <div class="row" style="background-color: rgba(0,0,0,.03); padding: .75rem 1.25rem; padding-bottom: 0px">
                                                    <div class="col-sm-3">
                                                        <div id="agr" style="display:none;" ><strong>Average Growth Rate: </strong><span id="growth-rate"></span></div>
                                                    </div>
                                                    <div class="col-sm-3 card" style="background-color: transparent; border-color: transparent">
                                                        <div class="form-group">
                                                            <div class="input-group">
                                                                <select id="trend-report" onchange="changeTrend(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    <option id="-1">Choose a report</option>
                                                                    <option id="disbursement">Disbursements</option>
                                                                    <option id="interest-received">Interest Received</option>
                                                                    <option id="interest-receivable">Interest Receivable</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <div class="form-group">
                                                            <div class="input-group">
                                                                <select id="trend-frequency" onchange="trendFrequencyChange(this)" class="form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    <option value="-1">All Time</option>
                                                                    <option value="2">Monthly</option>
                                                                    <option value="4">Quarterly</option>
                                                                    <option value="3">Yearly</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <div class="form-group">
                                                            <div class="input-group">
                                                                <select id="trend-year" onchange="trendYearChange(this)" class="year form-control" style="width:200px; margin: 0 5px; margin-left: 50px">
                                                                    <option value="0">Select Year</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="disburse-trend-chart" style="text-align: center; display: none">Charts will load here!</div><hr/>
                                                <div id="interest-received-trend-chart" style="text-align: center; display: none">Charts will load here!</div><hr/>
                                                <div id="interest-receivable-trend-chart" style="text-align: center; display: none">Charts will load here!</div><hr/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane fade" id="general-reports">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="col-sm-12" style="padding: 20px">
                                                <div class="row" style="padding-bottom: 10px">
                                                    <div class="col-sm-6">
                                                        <button id="individual-borrowers" class="btn col-sm-12 write">Individual Borrowers <i class="fa fa-download"></i></button><div id="ind-bor"></div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <button id="corporate-borrowers" class="btn btn-block col-sm-12 write">Corporate Borrowers <i class="fa fa-download"></i></button><div id="corp-bor"></div>
                                                    </div>
                                                </div>
                                                <div class="row" style="padding-bottom: 10px">
                                                    <div class="col-sm-6">
                                                        <button id="prin-officers" class="btn btn-block col-sm-12 write">Principal Officers <i class="fa fa-download"></i></button><div id="prin-off"></div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <button id="credit-information" class="btn btn-block col-sm-12 write">Credit Information <i class="fa fa-download"></i></button><div id="cred-info"></div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <!--<div class="col-sm-6">-->
                                                    <!--<button id="guarantors-information" class="btn btn-block col-sm-12">Guarantors Information <i class="fa fa-download"></i></button><div id="gua-info"></div>-->
                                                    <!--</div>-->
                                                    <div class="col-sm-6">
                                                        <button id="ptf-lr" class="btn btn-block col-sm-12 write">Portfolio Loan Risk <i class="fa fa-download"></i></button><div id="pf-lr"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div><!-- .animated -->
        <div id="wait" style=";width:150px;height:100px;position:fixed;top:50%;left:50%;padding:2px;z-index:99999;"><img src='spinner.gif' width="100" height="100" style="background-color: transparent"/></div>
    </div><!-- .content -->


</div><!-- /#right-panel -->
<div id="panels" include-html="/includes/notifications.html"></div>

<!-- Right Panel -->

<script src="assets/js/vendor/jquery-2.1.4.min.js"></script>
<script src="assets/js/popper.min.js"></script>
<script src="assets/js/plugins.js"></script>
<script src="assets/js/main.js"></script>
<script src="assets/js/lib/chosen/chosen.jquery.min.js"></script>
<!--<script src="js/jquery.timeago.js" type="text/javascript"></script>-->


<script src="assets/js/lib/data-table/datatables.min.js"></script>
<script src="assets/js/lib/data-table/dataTables.bootstrap.min.js"></script>
<script src="assets/js/lib/data-table/dataTables.buttons.min.js"></script>
<script src="assets/js/lib/data-table/buttons.bootstrap.min.js"></script>
<script src="assets/js/lib/data-table/jszip.min.js"></script>
<script src="assets/js/lib/data-table/pdfmake.min.js"></script>
<script src="assets/js/lib/data-table/vfs_fonts.js"></script>
<script src="assets/js/lib/data-table/buttons.html5.min.js"></script>
<script src="assets/js/lib/data-table/buttons.print.min.js"></script>
<script src="assets/js/lib/data-table/buttons.colVis.min.js"></script>
<script src="assets/js/lib/data-table/datatables-init.js"></script>
<!--<script-->
        <!--type="text/javascript"-->
        <!--src="https://code.jquery.com/jquery-3.3.1.min.js"-->
<!--&gt;</script>-->
<script
        type="text/javascript"
        src="https://unpkg.com/fusioncharts/fusioncharts.js"
></script>
<script
        type="text/javascript"
        src="https://unpkg.com/fusioncharts/themes/fusioncharts.theme.fusion.js"
></script>

<!--<script type="text/javascript" src="fscharts/js/fusioncharts.js"></script>-->
<!--<script type="text/javascript" src="fscharts/integrations/jquery/js/jquery-fusioncharts.js"></script>-->
<!--<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.fusion.js"></script>-->
<!--<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.candy.js"></script>-->
<!--<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.carbon.js"></script>-->
<!--<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.gammel.js"></script>-->
<!--<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.ocean.js"></script>-->
<!--<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.fint.js"></script>-->
<!--<script type="text/javascript" src="fscharts/js/themes/fusioncharts.theme.zune.js"></script>-->
<script type="text/javascript" src="fusioncharts/js/fusioncharts.js"></script>
<script type="text/javascript" src="fusioncharts/integrations/jquery/js/jquery-fusioncharts.js"></script>
<script type="text/javascript" src="fusioncharts/js/themes/fusioncharts.theme.fusion.js"></script>
<script type="text/javascript" src="fusioncharts/js/themes/fusioncharts.theme.candy.js"></script>
<script type="text/javascript" src="fusioncharts/js/themes/fusioncharts.theme.carbon.js"></script>
<script type="text/javascript" src="fusioncharts/js/themes/fusioncharts.theme.gammel.js"></script>
<script type="text/javascript" src="fusioncharts/js/themes/fusioncharts.theme.ocean.js"></script>
<script type="text/javascript" src="fusioncharts/js/themes/fusioncharts.theme.fint.js"></script>
<script type="text/javascript" src="fusioncharts/js/themes/fusioncharts.theme.zune.js"></script>
<script src="js/loader.js"></script>

<script src="js/notifications.js"></script>
<script src="js/excelexportjs.js"></script>
<script>
    jQuery(document).ready(function() {
        trends();
        loadYears('disburse-year');
        loadYears('branch-year');
        loadYears('payment-year');
        loadYears('i-r-year');
        loadYears('i-r-rec-year');
        loadYears('p-r-year');
        loadYears('p-r-rec-year');
        loadYears('pvi-year');
        loadYears('trend-year');
        loadYears('demo-year');
        getOfficers();
        getLoanClasses();
        getBranches();
        loadInfo();
        reloadAvgCards();
        disbursed();
        loadDisbursed();
//        initDisbursedGLP();
        var today = new Date().toISOString().split('T')[0];
        document.getElementsByName("filteraggprointend")[0].setAttribute('min', today);
        document.getElementsByName("filteraggprointstart")[0].setAttribute('min', today);
    });

    let amount_paid = {};
    let pvi_report = -1;

    function loadYears(id){
        var max = new Date().getFullYear(),
            min = max - 10,
            select = document.getElementById(id);

        for (var i = max; i>=min; i--){
            var opt = document.createElement('option');
            opt.value = i;
            opt.innerHTML = i;
            select.appendChild(opt);
        }
    }

    const formatter = new Intl.NumberFormat('en-US', {
        style: 'currency',
        currency: 'NGN'
    });

    var myTable = $('#disbursed-table')
        .DataTable({
            bAutoWidth: false,
            "aoColumns": [
                { "bSortable": false }, { "bSortable": true },
                null, null, { "bSortable": true },
            ],
            "buttons": [
                'copy', 'csv', 'excel', 'pdf', 'print'
            ],
            "aaSorting": [],
//            "bSearchable": false,
            select: {
                style: 'multi'
            }
        });

    var myTable2 = $('#payments-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                null, { "bSortable": true }, null
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable3 = $('#loan-by-branch-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                null, { "bSortable": true }, { "bSortable": true }, null
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable4 = $('#projected-interests-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                { "bSortable": true }, { "bSortable": true }
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable5 = $('#interests-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                { "bSortable": true }, { "bSortable": true }, null
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable6 = $('#bad-loans-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                null, { "bSortable": true }, null, null
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable7 = $('#overdues-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": false },
                null, { "bSortable": true }, null, null, null, null
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    var myTable8 = $('#glp-table')
        .DataTable({
            bAutoWidth: false,
            "aoColumns": [
                { "bSortable": false }, { "bSortable": true },
                null, null, { "bSortable": true },
            ],
            "aaSorting": [],
//            "bSearchable": false,
            select: {
                style: 'multi'
            }
        });

    var myTable9 = $('#interests-rec-table')
        .DataTable({
            bAutoWidth: true,
            "aoColumns": [
                { "bSortable": true },
                { "bSortable": true }, { "bSortable": true }, null
                // , null, { "bSortable": false },
            ],
            "aaSorting": [],
//            "bFilter": true,
//            "bSearchable": false,
            // "bInfo" : false,
            select: {
                style: 'multi'
            },
            "paging": true
        });

    $(document).on('click', '#individual-borrowers', function(e){
        loadIndividualBorrowersReport();
    });

    $(document).on('click', '#corporate-borrowers', function(e){
        loadCorporateBorrowersReport();
    });

    $(document).on('click', '#prin-officers', function(e){
        loadPrincipalOfficersReport();
    });

    $(document).on('click', '#credit-information', function(e){
        loadCreditInformationReport();
    });

    $(document).on('click', '#ptf-lr', function(e){
        loadPortfolioLoanRiskReport();
    });


    $(document).on("click", "#payments", function (e){
        loadPayments();
        payments();
    });

    $(document).on("click", "#branches", function (e){
        loadLoansByBranch();
        branches($('#branchreport').val());
    });

    $(document).on("click", "#disburse-button", function (e) {
        $("#rescheduled-div").hide();
        $("#disbursement-div").attr('class', 'col-sm-12');
        $("#disbursement-div").show();
        $("#disburse-button").attr('class', 'btn btn-primary col-sm-12');
        $("#reschedule-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#reschedule-button", function (e) {
//        loadLoansByBranch();
//        branches($('#branchreport').val());
        $("#rescheduled-div").show();
        $("#rescheduled-div").attr('class', 'col-sm-12');
        $("#disbursement-div").hide();
        $("#reschedule-button").attr('class', 'btn btn-primary col-sm-12');
        $("#disburse-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#interest-receivable-button", function (e) {
        loadInterestReceivable();
        interestreceivable();
        $("#interests-receivable-div").show();
        $("#interests-receivable-div").attr('class', 'col-sm-12');
        $("#interests-received-div").hide();
        $("#agg-prj-int-div").hide();
        $("#interest-receivable-button").attr('class', 'btn btn-primary col-sm-12');
        $("#interests-received-button").attr('class', 'btn col-sm-12');
        $("#gross-projected-interest-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#interests-received-button", function (e) {
        loadInterestReceived();
        interestreceived();
        $("#interests-received-div").show();
        $("#interests-received-div").attr('class', 'col-sm-12');
        $("#interests-receivable-div").hide();
        $("#agg-prj-int-div").hide();
        $("#interests-received-button").attr('class', 'btn btn-primary col-sm-12');
        $("#interests-receivable-button").attr('class', 'btn col-sm-12');
        $("#gross-projected-interest-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#principal-receivable-button", function (e) {
        loadPrincipalReceivable();
        principalreceivable();
        $("#principal-receivable-div").show();
        $("#principal-receivable-div").attr('class', 'col-sm-12');
        $("#principal-received-div").hide();
        $("#compare-principals-div").hide();
        $("#principal-receivable-button").attr('class', 'btn btn-primary col-sm-12');
        $("#principal-received-button").attr('class', 'btn col-sm-12');
        $("#compare-principals-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#principal-received-button", function (e) {
        loadPrincipalReceived();
        principalreceived();
        $("#principal-received-div").show();
        $("#principal-received-div").attr('class', 'col-sm-12');
        $("#principal-receivable-div").hide();
        $("#compare-principals-div").hide();
        $("#principal-received-button").attr('class', 'btn btn-primary col-sm-12');
        $("#principal-receivable-button").attr('class', 'btn col-sm-12');
        $("#compare-principals-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#pvi-received", function (e) {
        pvi_report = 'received';
        loadPVIReceived();
//        $("#pvi-received").attr('class', 'btn btn-primary col-sm-12');
        $("#pvi-receivable").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#pvi-receivable", function (e) {
        pvi_report = 'receivable';
        loadPVIReceivable();
        $("#pvi-receivable").attr('class', 'btn btn-primary col-sm-12');
        $("#pvi-received").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#gross-projected-interest-button", function (e) {
        loadAggProjectedInterests();
        $("#agg-prj-int-div").show();
        $("#agg-prj-int-div").attr('class', 'col-sm-12');
        $("#interests-receivable-div").hide();
        $("#interests-received-div").hide();
        $("#gross-projected-interest-button").attr('class', 'btn btn-primary col-sm-12');
        $("#interests-receivable-button").attr('class', 'btn col-sm-12');
        $("#interests-received-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#overdue-loans-button", function (e) {
        loadOverdues();
        $("#overdue-loans-div").show();
        $("#overdue-loans-div").attr('class', 'col-sm-12');
        $("#bad-loans-div").hide();
        $("#glp-div").hide();
        $("#overdue-loans-button").attr('class', 'btn btn-primary col-sm-12');
        $("#bad-loans-button").attr('class', 'btn col-sm-12');
        $("#glp-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#bad-loans-button", function (e) {
        loadBadLoans();
        $("#bad-loans-div").show();
        $("#bad-loans-div").attr('class', 'col-sm-12');
        $("#overdue-loans-div").hide();
        $("#glp-div").hide();
        $("#bad-loans-button").attr('class', 'btn btn-primary col-sm-12');
        $("#overdue-loans-button").attr('class', 'btn col-sm-12');
        $("#glp-button").attr('class', 'btn col-sm-12');
    });

    $(document).on("click", "#glp-button", function (e) {
        loadGLP();
        $("#glp-div").show();
        $("#glp-div").attr('class', 'col-sm-12');
        $("#overdue-loans-div").hide();
        $("#bad-loans-div").hide();
        $("#glp-button").attr('class', 'btn btn-primary col-sm-12');
        $("#overdue-loans-button").attr('class', 'btn col-sm-12');
        $("#bad-loans-button").attr('class', 'btn col-sm-12');
    });

    function check(){
        if (localStorage.getItem('role') != 1){
            jQuery('#car-models').hide();
            jQuery('#new-user').hide();
            jQuery('#models-card').hide();
            jQuery('#user').html(localStorage.getItem("name"));
        }
        else{
            jQuery('#user').html(localStorage.getItem("name"));
//                jQuery('#h-role').html(localStorage.getItem("user"));
        }
    }

    function loadMenus(){
        var modules = {};
        modules = JSON.parse(localStorage.getItem("modules"));
        modules.forEach(function(k, v){
            if (k.menu_name === 'Sub Menu'){
                let main = $.grep(modules, function(e){return e.id === parseInt(k.main_menu);});
                $('#'+$(main[0]['module_tag']).attr('id') + ' > .sub-menu').append(k.module_tag);
            }else if(k.menu_name === 'Main Menu'){
                $('#sidebar').append(k.module_tag);
                $('#'+$(k.module_tag).attr('id')).append('<ul class="sub-menu children dropdown-menu"></ul>');
            }else{
                $('#'+k.module_name).show();
            }
        });
        $.ajax({
            type: "GET",
            url: "/user/all-requests",
            success: function (response) {
                $.each(response, function(k,v){
                    $('#requests-badge').html(v.requests);
                });
            }
        });
        $.ajax({
            type: "GET",
            url: "/user/all-applications",
            success: function (response) {
                $.each(response, function(k,v){
                    $('#applications-badge').html(v.applications);
                });
            }
        });
    }

    function read_write(){
        let w;
        var perms = JSON.parse(localStorage.getItem("permissions"));
        var page = (window.location.pathname.split('/')[1].split('.'))[0];
        perms.forEach(function (k,v){
            if (k.module_name === page){
                w = $.grep(perms, function(e){return e.id === parseInt(k.id);});
            }
        });
        if (w && w[0] && (parseInt(w[0]['editable']) !== 1)){
            $(".write").hide();
        }

        if  ($.grep(perms, function(e){return e.module_name === 'indBorrowersReport';}) &&
            ($.grep(perms, function(e){return e.module_name === 'indBorrowersReport';}))[0] &&
            ($.grep(perms, function(e){return e.module_name === 'indBorrowersReport';}))[0]['read_only'] === '0')
            $('#individual-borrowers').hide();
        if ($.grep(perms, function(e){return e.module_name === 'corporateBorrowersReport';}) &&
            ($.grep(perms, function(e){return e.module_name === 'corporateBorrowersReport';}))[0] &&
            ($.grep(perms, function(e){return e.module_name === 'corporateBorrowersReport';}))[0]['read_only'] === '0')
            $('#corporate-borrowers').hide();
        if ($.grep(perms, function(e){return e.module_name === 'prinOfficersReport';}) &&
            ($.grep(perms, function(e){return e.module_name === 'prinOfficersReport';}))[0] &&
            ($.grep(perms, function(e){return e.module_name === 'prinOfficersReport';}))[0]['read_only'] === '0')
            $('#prin-officers').hide();
        if ($.grep(perms, function(e){return e.module_name === 'creditInformationReport';}) &&
            ($.grep(perms, function(e){return e.module_name === 'creditInformationReport';}))[0] &&
            ($.grep(perms, function(e){return e.module_name === 'creditInformationReport';}))[0]['read_only'] === '0')
            $('#credit-information').hide();
        if ($.grep(perms, function(e){return e.module_name === 'portAtRiskReport';}) &&
            ($.grep(perms, function(e){return e.module_name === 'portAtRiskReport';}))[0] &&
            ($.grep(perms, function(e){return e.module_name === 'portAtRiskReport';}))[0]['read_only'] === '0')
            $('#ptf-lr').hide();
    }

    function padWithZeroes(n, width, z) {
        z = z || '0';
        n = n + '';
        return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;
    }

    function loadInfo(){
        $.ajax({
            'url': 'user/report-cards/',
            'type': 'get',
            'success': function (data) {
                populateCards(data.response);
            },
            'error': function (err) {
                //alert ('Error');
                console.log(err);
            }
        });
    }

    function populateCards(data){
        $('#branch').html(data.branches[0]["branches"]);
        $('#loan-officers').html(data.loan_officers[0]["loan_officers"]);
        $('#loans-active').html(data.active_loans[0]["all_applications"]);
        $('#loan-per').html(data["avg_loan_per_officers"]);
    }

    function initDisbursedGLP(){
        $.ajax({
            'url': 'user/disbursements/filter',
            'type': 'get',
            'success': function (data) {
                if (data.status === 200) {
                    let disbursed = $.extend(true, {}, data.response),
                        glp = $.extend(true, {}, data.response);
//                    populateDisbursed(disbursed);
                    populateGLP(glp);
                } else {
                    swal({"icon": "error", "text": 'Database Error'});
                }
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function loadAvgCards(){
        if (localStorage.getItem('avg_loan_balance') && localStorage.getItem('avg_disbursed')){
            $('#avg-loan-balance').html(formatter.format(localStorage.getItem('avg_loan_balance')));
            $('#avg-loan-disbursed').html(formatter.format(localStorage.getItem('avg_disbursed')));
        }
        else {
            $.ajax({
                'url': 'user/disbursements/filter',
                'type': 'get',
                'success': function (data) {
                    if (data.status === 200) {
                        let glp = $.extend(true, {}, data.response);
                        populateAvgCards(glp);
                    } else {
                        swal({"icon": "error", "text": 'Database Error'});
                    }
                },
                'error': function (err) {
                    swal('Error in Connection!','','error')
                }
            });
        }
    }

    function reloadAvgCards(){
        $.ajax({
            'url': 'user/disbursements/filter',
            'type': 'get',
            'success': function (data) {
                if (data.status === 200) {
                    let glp = $.extend(true, {}, data.response);
                    populateAvgCards(glp);
                } else {
                    swal({"icon": "error", "text": 'Database Error'});
                }
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function loadDisbursed(){
        if (localStorage.getItem('disbursed')){
            $('#disbursed-table').DataTable({
                dom: 'Blfrtip',
                bDestroy: true,
                data: JSON.parse(localStorage.getItem('disbursed')),
                search: {search: ' '},
                buttons: [
                    'copy', 'csv', 'excel', 'pdf', 'print'
                ],
                columns: [
                    { data: "id" },
                    { data: "fullname" },
                    { data: "principal" },
                    { data: "date" }
                ]
            });
            $('#total-disbursements').html(formatter.format(localStorage.getItem('total-disbursements')));
        } else {
            let start = $("#startDate").val(),
                end = $("#endDate").val(),
                url;
            url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements-new/filter' : 'user/disbursements-new/filter?start='+formatDate(start)+'&&end='+formatDate(end)

            $.ajax({
                'url': url,
                'type': 'get',
                'success': function (data) {
                    (data.status === 200) ? populateDisbursed(data.response) :  swal({"icon": "error", "text": 'Database Error'})
                },
                'error': function (err) {
                    swal('Error in Connection!','','error')
                }
            });
        }
    }

    function reloadDisbursed(){
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements-new/filter' : 'user/disbursements-new/filter?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateDisbursed(data.response) :  swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function loadGLP(){
        let start = $("#startGLPDate").val(),
            end = $("#endGLPDate").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements/filter' : 'user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateGLP(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

//    function populateDisbursed(dets){
//        $("#disbursed-table").dataTable().fnClearTable();
//        if (dets.length === 0){
//            $("#disbursed-table").dataTable().fnClearTable();
//        }else{
//            var total = 0; var totalglp = 0; var totalbalance = 0; var num_all = 0; var num_paid = 0; var pay = 0; var loa = 0;
//            let d = []; let processed_data = [];
//            var totalhere = 0;
//            const delimit = (dets.without_pay.length > dets.with_payments.length)? dets.without_pay.length : dets.with_payments.length;
//            const limit = (dets.with_invalid_payments.length > delimit)? dets.with_invalid_payments.length : delimit;
//            for (let i=0; i<limit; i++){
//                let v = {};
//                v = dets.without_pay[i];
//                if (v){
//                    let nopay = [];
//                    amount_paid[v.ID] = 0;
//                    totalhere += parseFloat(v.loan_amount);
//                    total+= (v.loan_amount) ? parseFloat(v.loan_amount) : 0
//                    totalglp += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
//                    totalbalance += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
//                    num_all++;
//                    v.id = padWithZeroes(parseInt(v.ID),6);
//                    v.balance = formatter.format(parseFloat(v.loan_amount));
//                    v.principal = formatter.format(parseFloat(v.loan_amount));
//                    if (v.reschedule_amount)
//                        v.date_ = formatDate(v.date_modified.split(' ')[0]);
//                    else
//                        v.date_ = formatDate(v.disbursement_date);
//                    processed_data.push(v);
//                }
//
//                v = {};
//                v = dets.with_payments[i];
//                if (v){
//                    amount_paid[v.applicationID] = v.valid_payment;
//                    loa += v.loan_amount;
//                    num_all++;
//                    num_paid++;
//                    total += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
//                    pay+=v.valid_payment;
//                    totalbalance += (v.paid) ? ((v.invalid_payment === null) ? parseFloat(v.balance) :  v.loan_amount - (parseFloat(v.paid) - parseFloat(v.invalid_payment))) : 0;
//                    v.id = padWithZeroes(parseInt(v.applicationID),6);
//                    v.balance = formatter.format(parseFloat((v.loan_amount - v.valid_payment) < 0 ? 0 : v.loan_amount - v.valid_payment));
//                    v.principal = formatter.format(parseFloat(v.loan_amount));
//                    if (v.reschedule_amount)
//                        v.date_ = formatDate(v.date_modified.split(' ')[0]);
//                    else
//                        v.date_ = formatDate(v.date);
//                    processed_data.push(v);
//                }
//
//                v={}
//                v = dets.with_invalid_payments[i];
//                if (v){
//                    amount_paid[v.applicationID] = v.valid_payment;
//                    loa += v.loan_amount;
//                    num_all++;
//                    num_paid++;
//                    total += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
//                    pay+=v.valid_payment;
////                    totalbalance += (v.paid) ? ((v.invalid_payment === null) ? parseFloat(v.balance) :  v.loan_amount - (parseFloat(v.paid) - parseFloat(v.invalid_payment))) : 0;
//                    totalbalance += parseFloat(v.loan_amount);
//                    v.id = padWithZeroes(parseInt(v.applicationID),6);
//                    v.balance = formatter.format(parseFloat(v.loan_amount));
//                    v.principal = formatter.format(parseFloat(v.loan_amount));
//                    if (v.reschedule_amount)
//                        v.date_ = formatDate(v.date_modified.split(' ')[0]);
//                    else
//                        v.date_ = formatDate(v.date);
//                    processed_data.push(v);
//                }
//
//                if (i === limit-1){
//                    $('#disbursed-table').DataTable({
//                        dom: 'Blfrtip',
//                        bDestroy: true,
//                        data: processed_data,
//                        search: {search: ' '},
//                        buttons: [
//                            'copy', 'csv', 'excel', 'pdf', 'print'
//                        ],
//                        columns: [
//                            { data: "id" },
//                            { data: "fullname" },
//                            { data: "principal" },
////                            { data: "balance" },
//                            { data: "date_" }
//                        ]
//                    });
//                }
//            }
//            $('#total-disbursements').html(formatter.format(total));
////            $('#glp').html(formatter.format(totalglp));
////            $('#avg-loan-balance').html(formatter.format((num_all === 0) ? 0: totalbalance/num_all));
////            $('#avg-loan-disbursed').html(formatter.format((num_all === 0) ? 0: total/num_all));
//        }
//    }

    function populateDisbursed(dets){
        $("#disbursed-table").dataTable().fnClearTable();
        if (dets.length > 0){
            var total = 0; var totalglp = 0; var totalbalance = 0; var num_all = 0; var num_paid = 0; var pay = 0; var loa = 0;
            let d = []; let processed_data = [];
            var totalhere = 0;
            for (let i=0; i<dets.length; i++){

                v = {};
                v = dets[i];
                if (v){
                    total += (v.loan_amount) ? parseFloat(v.loan_amount) : 0;
                    v.id = padWithZeroes(parseInt(v.applicationID),6);
                    v.balance = formatter.format(parseFloat((v.loan_amount - v.valid_payment) < 0 ? 0 : v.loan_amount - v.valid_payment));
                    v.principal = (v.loan_amount) ? formatter.format(parseFloat(v.loan_amount)) : 0;
                    v.f_date = v.date.split(' ')[0];
                    processed_data.push(v);
                }
            }

            $('#disbursed-table').DataTable({
                dom: 'Blfrtip',
                bDestroy: true,
                data: processed_data,
                search: {search: ' '},
                buttons: [
                    'copy', 'csv', 'excel', 'pdf', 'print'
                ],
                columns: [
                    { data: "id" },
                    { data: "fullname" },
                    { data: "principal" },
                    { data: "f_date" }
                ]
            });
            localStorage.setItem('disbursed', JSON.stringify(processed_data));
            localStorage.setItem('total-disbursements', total);
            $('#total-disbursements').html(formatter.format(total));
        }
    }

    function populateGLP(dets){
        $("#glp-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#glp-table").dataTable().fnClearTable();
        }else{
            let processed_data = [];
            var total = 0; var totalglp = 0; var totalbalance = 0; var num_all = 0; var num_paid = 0; var pay = 0; var loa = 0;
            var totalhere = 0;
            const delimit = (dets.without_pay.length > dets.with_payments.length)? dets.without_pay.length : dets.with_payments.length;
            const limit = (dets.with_invalid_payments.length > delimit)? dets.with_invalid_payments.length : delimit;
            for (let i=0; i<limit; i++){
                let v = {};
                v = dets.without_pay[i];
                if (v){
//                    amount_paid[v.ID] = 0;
                    totalhere += parseFloat(v.loan_amount);
                    total+= (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                    totalglp += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                    totalbalance += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                    num_all++;
                    v.id = padWithZeroes(parseInt(v.ID),6);
                    v.principal = formatter.format(parseFloat(v.loan_amount));
                    v.balance = formatter.format(parseFloat(v.loan_amount));
                    v.date = formatDate(v.disbursement_date);
                    processed_data.push(v);
                }

                v = {};
                v = dets.with_payments[i];
                if (v){
//                    amount_paid[v.applicationID] = v.valid_payment;
                    loa += v.loan_amount;
                    num_all++;
                    num_paid++;
                    total += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                    pay+=v.valid_payment;
                    totalbalance += (v.paid) ? ((v.invalid_payment === null) ? parseFloat(v.balance) :  v.loan_amount - (parseFloat(v.paid) - parseFloat(v.invalid_payment))) : 0;
                    if ((parseFloat(v.loan_amount - v.valid_payment) > 0)){
                        totalglp += (v.loan_amount) ? parseFloat(v.loan_amount - v.valid_payment) : 0;
                        pay+=v.valid_payment;
                        v.id = padWithZeroes(parseInt(v.applicationID),6);
                        v.principal = formatter.format(parseFloat(v.loan_amount));
                        v.balance = formatter.format(parseFloat(v.loan_amount - v.valid_payment));
                        v.date = formatDate(v.date);
                        processed_data.push(v);
                    }
                }

                v={}
                v = dets.with_invalid_payments[i];
                if (v){
//                    amount_paid[v.applicationID] = v.valid_payment;
                    loa += v.loan_amount;
                    num_all++;
                    num_paid++;
                    total += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                    pay+=v.valid_payment;
//                    totalbalance += (v.paid) ? ((v.invalid_payment === null) ? parseFloat(v.balance) :  v.loan_amount - (parseFloat(v.paid) - parseFloat(v.invalid_payment))) : 0;
                    totalbalance += parseFloat(v.loan_amount);
                    v.id = padWithZeroes(parseInt(v.applicationID),6);
                    v.balance = formatter.format(parseFloat(v.loan_amount));
                    v.principal = formatter.format(parseFloat(v.loan_amount));
                    processed_data.push(v);
                }

                if (i === limit-1){
                    $('#glp-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: processed_data,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            { data: "id" },
                            { data: "fullname" },
                            { data: "principal" },
                            { data: "balance" },
                            { data: "date" }
                        ]
                    });
                }
            }
            $('#glp').html(formatter.format(totalglp));
            $('#avg-loan-balance').html(formatter.format((num_all === 0) ? 0: totalbalance/num_all));
            $('#avg-loan-disbursed').html(formatter.format((num_all === 0) ? 0: total/num_all));
        }
    }

    function populateAvgCards(dets){
        if (dets.length === 0){
            $('#avg-loan-balance').html(formatter.format(0));
            $('#avg-loan-disbursed').html(formatter.format(0));
        }else{
            let processed_data = [];
            var total = 0; var totalglp = 0; var totalbalance = 0; var num_all = 0; var num_paid = 0; var pay = 0; var loa = 0;
            var totalhere = 0;
            const delimit = (dets.without_pay.length > dets.with_payments.length)? dets.without_pay.length : dets.with_payments.length;
            const limit = (dets.with_invalid_payments.length > delimit)? dets.with_invalid_payments.length : delimit;
            for (let i=0; i<limit; i++){
                let v = {};
                v = dets.without_pay[i];
                if (v){
                    amount_paid[v.ID] = 0;
                    total+= (v.loan_amount) ? parseFloat(v.loan_amount) : 0;
                    totalbalance += (v.loan_amount) ? parseFloat(v.loan_amount) : 0
                    num_all++;
                }

                v = {};
                v = dets.with_payments[i];
                if (v){
                    amount_paid[v.applicationID] = v.valid_payment;
                    num_paid++;
                    total += (v.loan_amount) ? parseFloat(v.loan_amount) : 0;
                    totalbalance += (v.paid) ? ((v.invalid_payment === null) ? parseFloat(v.balance) :  v.loan_amount - (parseFloat(v.paid) - parseFloat(v.invalid_payment))) : 0;
                }

                v={}
                v = dets.with_invalid_payments[i];
                if (v){
                    amount_paid[v.applicationID] = v.valid_payment;
                    num_all++;
                    total += (v.loan_amount) ? parseFloat(v.loan_amount) : 0;
                    totalbalance += parseFloat(v.loan_amount);
                }
            }
            localStorage.setItem('avg_loan_balance', (num_all === 0) ? 0: totalbalance/num_all);
            localStorage.setItem('avg_disbursed', (num_all === 0) ? 0: total/num_all);
            $('#avg-loan-balance').html(formatter.format((num_all === 0) ? 0: totalbalance/num_all));
            $('#avg-loan-disbursed').html(formatter.format((num_all === 0) ? 0: total/num_all));
        }
    }

    function refreshDisbursements(){
        reloadDisbursed();
    }

    function refresh(){
        loadInfo();
        reloadAvgCards();
    }

//    $("#filterdisbursements").submit(function (e) {
//        e.preventDefault();
//
//        let start = $("#startDate").val(),
//            end = $("#endDate").val(),
//            type = $("#type-filter").val(),
//            officer = $('#filter-officers').find('option:selected').attr('id'),
//            url = '/user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end);
//        let urlAn;
//        if (start && end && officer==0){
//            urlAn = 'user/analytics?t=disbursements&&start='+formatDate(start)+'&&end='+formatDate(end);
//            url = '/user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end);
//        }
//        if ((!start || !end) && officer==0 ) {
//            return loadDisbursed();
//        }
//        if (officer != 0){
//            url = url.concat('&&officer='+officer);
//            urlAn = 'user/analytics?t=disbursements&&start='+formatDate(start)+'&&end='+formatDate(end)+'&&officer='+officer;
//        }
//        let d=[];
//        $.ajax({
//            'url': url,
//            'type': 'get',
//            'success': function (data) {
//                let applications = data.response;
//                results = applications;
//                populateDisbursed(applications);
//            },
//            'error': function (err) {
//                console.log(err);
//            }
//        });
////        $.ajax({
////            'url': urlAn,
////            'type': 'get',
////            'success': function (data) {
//////                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
////                jQuery.each(data.response, function(k, v){
////                    if (v.name)
////                        d.push({label: v.name , value: v.amount_disbursed}, );
////                    if (v.DisburseYearMonth)
////                        d.push({label: v.DisburseMonth , value: v.AmountDisbursed}, );
////
////                });
////                var chartConfigs = {
////                    type: 'column2d', // The chart type
////                    width: '100%', // Width of the chart
////                    height: '400', // Height of the chart
////                    dataFormat: 'json', // Data type
////                    dataSource: {
////                        // Chart Configuration
////                        "chart": {
////                            "caption": "Disbursements by Loan Officer(s)",
//////                            "subCaption": "In MMbbl = One Million barrels",
////                            "xAxisName": "Loan Officers",
////                            "yAxisName": "Amount Disbursed (Naira)",
////                            "numberSuffix": " Naira",
////                            "theme": "fusion",
////                        },
////                        // Chart Data
////                        "data": d
////                    }
////                };
////                $("#chart-container").insertFusionCharts(chartConfigs);
////            },
////            'error': function (err) {
////                swal('Error in Connection!','','error')
////            }
////        });
//    });

    $("#filterdisbursements").submit(function (e) {
        e.preventDefault();

        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            type = $("#type-filter").val(),
            officer = $('#filter-officers').find('option:selected').attr('id'),
            url = '/user/disbursements-new/filter?start='+formatDate(start)+'&&end='+formatDate(end);
        let urlAn;
        if (start && end && officer==0){
            urlAn = 'user/analytics?t=disbursements&&start='+formatDate(start)+'&&end='+formatDate(end);
            url = '/user/disbursements-new/filter?start='+formatDate(start)+'&&end='+formatDate(end);
        }
        if ((!start || !end) && officer==0 ) {
            return loadDisbursed();
        }
        if (officer != 0){
            url = url.concat('&&officer='+officer);
            urlAn = 'user/analytics?t=disbursements&&start='+formatDate(start)+'&&end='+formatDate(end)+'&&officer='+officer;
        }
        let d=[];
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateDisbursed(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
//        $.ajax({
//            'url': urlAn,
//            'type': 'get',
//            'success': function (data) {
////                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
//                jQuery.each(data.response, function(k, v){
//                    if (v.name)
//                        d.push({label: v.name , value: v.amount_disbursed}, );
//                    if (v.DisburseYearMonth)
//                        d.push({label: v.DisburseMonth , value: v.AmountDisbursed}, );
//
//                });
//                var chartConfigs = {
//                    type: 'column2d', // The chart type
//                    width: '100%', // Width of the chart
//                    height: '400', // Height of the chart
//                    dataFormat: 'json', // Data type
//                    dataSource: {
//                        // Chart Configuration
//                        "chart": {
//                            "caption": "Disbursements by Loan Officer(s)",
////                            "subCaption": "In MMbbl = One Million barrels",
//                            "xAxisName": "Loan Officers",
//                            "yAxisName": "Amount Disbursed (Naira)",
//                            "numberSuffix": " Naira",
//                            "theme": "fusion",
//                        },
//                        // Chart Data
//                        "data": d
//                    }
//                };
//                $("#chart-container").insertFusionCharts(chartConfigs);
//            },
//            'error': function (err) {
//                swal('Error in Connection!','','error')
//            }
//        });
    });

    $("#filterglp").submit(function (e) {
        e.preventDefault();

        let start = $("#startGLPDate").val(),
            end = $("#endGLPDate").val(),
            url = '/user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end ) {
            return loadGLP();
        }
        if (officer != 0){
            url = url.concat('&&officer='+officer);
        }

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateGLP(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadPayments(){
        let start = $("#paystart").val(),
            end = $("#payend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/payments/' : 'user/payments?start='+formatDate(start)+'&&end='+formatDate(end)
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populatePayments(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populatePayments(dets){
        $("#payments-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#payments-table").dataTable().fnClearTable();
        }else{
            let deta = [];
            var total = 0;
            const count = dets.payment.length;
            for (let i = 0; i < count; i ++){
                let v = dets.payment[i];
                v.client = padWithZeroes(parseInt(v.clientid),6);
                v.amount = formatter.format(parseFloat(v.paid + v.interest));
                deta.push(v);
                if (i === count - 1){
                    $('#payments-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: deta,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            { data: "client" },
                            { data: "fullname" },
                            { data: "amount" },
                            { data: "date" }
                        ]
                    });
                }
            }
            total = dets.total[0]["total"];
            $('#total-payments').html(formatter.format(total));
        }
    }

    $("#filterpayments").submit(function (e) {
        e.preventDefault();

        let start = $("#paystart").val(),
            end = $("#payend").val(),
            url = '/user/payments/?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadPayments();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populatePayments(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadLoansByBranch(){
        let start = $("#filterbranchstart").val(),
            end = $("#filterbranchend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/loans-by-branches/' : 'user/loans-by-branches?start='+formatDate(start)+'&&end='+formatDate(end)
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateLoanByBranch(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populateLoanByBranch(dets){
        $("#loan-by-branch-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#loan-by-branch-table").dataTable().fnClearTable();
            $('#total-loans-by-branch').html(formatter.format(0));
        }else{
            let deta = [];
            var total = 0; var collected = 0;
            let num = dets.length;
            for (let i = 0; i < num; i++){
                let v = dets[i];
                total += (v.disbursed) ? v.disbursed : 0;
                v.id = padWithZeroes(v.branchID, 6);
                v.amount = formatter.format(v.disbursed);
                v.paid = formatter.format(v.collected);
                v.glp = formatter.format(v.disbursed - v.collected);
                deta.push(v);
                if (i === num - 1){
                    $('#loan-by-branch-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: deta,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            { data: "id" },
                            { data: "branch" },
                            { data: "amount" },
                            { data: "paid" },
                            { data: "glp" }
                        ]
                    });
                }
            }
            $('#total-loans-by-branch').html(formatter.format(total));
        }
    }

    function loadInterestsByBranch(){
        let start = $("#filterinterestbranchstart").val(),
            end = $("#filterinterestbranchend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/interests-by-branches/' : 'user/interests-by-branches?start='+formatDate(start)+'&&end='+formatDate(end)
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateInterestsByBranch(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populateInterestsByBranch(dets){
        $("#interest-by-branch-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#interest-by-branch-table").dataTable().fnClearTable();
            $('#total-interest-by-branch').html(formatter.format(0));
        }else{
            let deta = [];
            var total = 0; var collected = 0;
            let num = dets.length;
            for (let i = 0; i < num; i++){
                let v = dets[i];
                total += (v.interest_expected) ? v.interest_expected : 0;
                v.id = padWithZeroes(v.branchID, 6);
                v.amount = formatter.format(v.interest_expected);
                v.paid = formatter.format(v.collected);
                v.glp = formatter.format(v.disbursed - v.collected);
                deta.push(v);
                if (i === num - 1){
                    $('#interest-by-branch-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: deta,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            { data: "id" },
                            { data: "branch" },
                            { data: "amount" },
                            { data: "paid" }
                        ]
                    });
                }
            }
            $('#total-interest-by-branch').html(formatter.format(total));
        }
    }

    function loadPaymentsByBranch(){
        let start = $("#filterpaymentsbranchstart").val(),
            end = $("#filterpaymentsbranchend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/payments-by-branches/' : 'user/payments-by-branches?start='+formatDate(start)+'&&end='+formatDate(end)
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populatePaymentsByBranch(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populatePaymentsByBranch(dets){
        $("#payments-by-branch-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#payments-by-branch-table").dataTable().fnClearTable();
            $('#total-payments-by-branch').html(formatter.format(0));
        }else{
            let deta = [];
            var total = 0; var collected = 0;
            let num = dets.length;
            for (let i = 0; i < num; i++){
                let v = dets[i];
                total += (v.disbursed) ? v.disbursed : 0;
                v.id = padWithZeroes(v.branchID, 6);
                v.amount = formatter.format(v.disbursed);
                v.paid = formatter.format(v.collected);
                v.glp = formatter.format(v.disbursed - v.collected);
                deta.push(v);
                if (i === num - 1){
                    $('#payments-by-branch-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: deta,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            { data: "id" },
                            { data: "branch" },
                            { data: "amount" },
                            { data: "paid" }
                        ]
                    });
                }
            }
            $('#total-payments-by-branch').html(formatter.format(total));
        }
    }

    function loadBadloansByBranch(){
        let start = $("#filterbadloansbranchstart").val(),
            end = $("#filterbadloansbranchend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/badloans-by-branches/' : 'user/badloans-by-branches?start='+formatDate(start)+'&&end='+formatDate(end)
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateBadloansByBranch(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populateBadloansByBranch(dets){
        $("#badloans-by-branch-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#badloans-by-branch-table").dataTable().fnClearTable();
            $('#total-badloans-by-branch').html(formatter.format(0));
        }else{
            let deta = [];
            var total = 0; var collected = 0;
            let num = dets.length;
            for (let i = 0; i < num; i++){
                let v = dets[i];
                total += (v.amount) ? v.amount : 0;
                v.id = padWithZeroes(v.branchID, 6);
                v.amount = formatter.format(v.amount);
                deta.push(v);
                if (i === num - 1){
                    $('#badloans-by-branch-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: deta,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            { data: "id" },
                            { data: "branch" },
                            { data: "amount" }
                        ]
                    });
                }
            }
            $('#total-badloans-by-branch').html(formatter.format(total));
        }
    }

    $("#filterbybranch").submit(function (e) {
        e.preventDefault();

        let start = $("#filterbranchstart").val(),
            end = $("#filterbranchend").val(),
            url = '/user/loans-by-branches?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadLoansByBranch();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateLoanByBranch(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    $("#filterinterestbybranch").submit(function (e) {
        e.preventDefault();

        let start = $("#filterinterestbranchstart").val(),
            end = $("#filterinterestbranchend").val(),
            url = '/user/interests-by-branches?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadInterestsByBranch();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateInterestsByBranch(applications);
            },
            'error': function (err) {
                return swal(err);
            }
        });
    });

    $("#filterpaymentsbybranch").submit(function (e) {
        e.preventDefault();

        let start = $("#filterpaymentsbranchstart").val(),
            end = $("#filterpaymentsbranchend").val(),
            url = '/user/payments-by-branches?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadPaymentsByBranch();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populatePaymentsByBranch(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    $("#filterbadloansbybranch").submit(function (e) {
        e.preventDefault();

        let start = $("#filterbadloansbranchstart").val(),
            end = $("#filterbadloansbranchend").val(),
            url = '/user/badloans-by-branches?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadBadloansByBranch();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateBadloansByBranch(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadProjectedInterests(){
        let start = $("#filterprointstart").val(),
            end = $("#filterprointend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/projected-interests/' : 'user/projected-interests?start='+formatDate(start)+'&&end='+formatDate(end)
        $.ajax({
            'url': 'user/projected-interests/',
            'type': 'get',
            'success': function (data) {
                populateProjectedInterests(data);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populateProjectedInterests(dets){
        $("#projected-interests-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#projected-interests-table").dataTable().fnClearTable();
        }else{
            let full = [],
                total = 0;

            dets.response.due.forEach(function (applications) {
                let payments = $.grep(dets.response.paid, function (e) {return e.applicationID === applications.applicationID});
                if (payments && payments[0])
                    applications.payments = payments[0]['interest_paid'];
                full.push(applications);
            });
            $.each(full, function(k,v){
                if (v.payments){
                    if ((v.interest_due - v.payments) > 0 ){
                        total+= parseFloat(v.interest_due - v.payments);
                        $("#projected-interests-table").dataTable().fnAddData([
                            padWithZeroes(v.clientID, 6), v.client, formatter.format(parseFloat(v.interest_due - v.payments))
                        ]);
                    }
                }else{
                    total += parseFloat(v.interest_due - 0)
                    $("#projected-interests-table").dataTable().fnAddData([
                        padWithZeroes(v.clientID, 6), v.client, formatter.format(parseFloat(v.interest_due - 0))
                    ]);
                }
            });
            $('#total-interests').html(formatter.format(total));
        }
    }

    $("#filterprojectedinterest").submit(function (e) {
        e.preventDefault();

        let start = $("#filterprointstart").val(),
            end = $("#filterprointend").val(),
            url = '/user/projected-interests?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadProjectedInterests();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data;
                results = applications;
                populateProjectedInterests(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadAggProjectedInterests(){
        let start = $("#filteraggprointstart").val(),
            end = $("#filteraggprointend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/agg-projected-interests/' : 'user/agg-projected-interests?start='+formatDate(start)+'&&end='+formatDate(end)
        $.ajax({
            'url': 'user/agg-projected-interests/',
            'type': 'get',
            'success': function (data) {
                var value = data.response[0]['total'];
                $('#total-projected-interest').html(formatter.format(value));
                $('#agg-interests').html(formatter.format(value));
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    $("#filteraggprojectedinterest").submit(function (e) {
        e.preventDefault();

        let start = $("#filteraggprointstart").val(),
            end = $("#filteraggprointend").val(),
            url = '/user/agg-projected-interests?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadAggProjectedInterests();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                var value = data.response[0]['total'];
                $('#total-projected-interest').html(formatter.format(value));
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadInterestReceived(){
        let start = $("#filterintereststart").val(),
            end = $("#filterinterestend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/interests' : 'user/interests?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateInterestReceived(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function loadInterestReceivable(){
        let start = $("#filterinterestrecstart").val(),
            end = $("#filterinterestrecend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/interests-receivable' : 'user/interests-receivable?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateInterestReceivable(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populateInterestReceived(dets){
        $("#interests-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#interests-table").dataTable().fnClearTable();
            $('#total-interests-earned').html(formatter.format(0));
        }else{
            var total = 0; let deta = []; let num = dets.length;
            for (let i = 0; i < num; i ++){
                let v = dets[i];
                total+= parseFloat(v.paid);
                v.id = padWithZeroes(parseInt(v.applicationID),6);
                v.amount = formatter.format(parseFloat(v.paid));
                deta.push(v);
                if (i === num - 1){
                    $('#interests-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: deta,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            { data: "id" },
                            { data: "fullname" },
                            { data: "amount" },
                            { data: "loan_officer" }
                        ]
                    });
                }
            }
            $('#total-interests-earned').html(formatter.format(total));
        }
    }

    function populateInterestReceivable(dets){
        $("#interests-rec-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#interests-rec-table").dataTable().fnClearTable();
            $('#total-interests-rec').html(formatter.format(0));
        }else{
            var total = 0; let deta = [];let num = dets.length;
            for (let i = 0; i < num; i ++) {
                let v = dets[i];
                v.id = padWithZeroes(parseInt(v.applicationID), 6);
                v.amount = formatter.format(parseFloat(v.due));
                deta.push(v);
                total += parseFloat(v.due);
                if (i === num - 1) {
                    $('#interests-rec-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: deta,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            {data: "id"},
                            {data: "fullname"},
                            {data: "amount"},
                            {data: "loan_officer"}
                        ]
                    });
                }
            }
            $('#total-interests-rec').html(formatter.format(total));
        }
    }

    function loadPrincipalReceived(){
        let start = $("#filterprincipalstart").val(),
            end = $("#filterprincipalend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/principal' : 'user/principal?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populatePrincipalReceived(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function loadPrincipalReceivable(){
        let start = $("#filterprincipalrecstart").val(),
            end = $("#filterprincipalrecend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/principal-receivable' : 'user/principal-receivable?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populatePrincipalReceivable(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populatePrincipalReceived(dets){
        $("#principal-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#principal-table").dataTable().fnClearTable();
            $('#total-principal-earned').html(formatter.format(0));
        }else{
            var total = 0; let deta = []; let num = dets.length;
            for (let i = 0; i < num; i ++){
                let v = dets[i];
                total+= parseFloat(v.paid);
                v.id = padWithZeroes(parseInt(v.applicationID),6);
                v.amount = formatter.format(parseFloat(v.paid));
                deta.push(v);
                if (i === num - 1){
                    $('#principal-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: deta,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            { data: "id" },
                            { data: "fullname" },
                            { data: "amount" },
                            { data: "loan_officer" }
                        ]
                    });
                }
            }
            $('#total-principal-earned').html(formatter.format(total));
        }
    }

    function populatePrincipalReceivable(dets){
        $("#principal-rec-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#principal-rec-table").dataTable().fnClearTable();
            $('#total-principal-rec').html(formatter.format(0));
        }else{
            var total = 0; let deta = [];let num = dets.length;
            for (let i = 0; i < num; i ++) {
                let v = dets[i];
                v.id = padWithZeroes(parseInt(v.applicationID), 6);
                v.amount = formatter.format(parseFloat(v.due));
                deta.push(v);
                total += parseFloat(v.due);
                if (i === num - 1) {
                    $('#principal-rec-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: deta,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            {data: "id"},
                            {data: "fullname"},
                            {data: "amount"},
                            {data: "loan_officer"}
                        ]
                    });
                }
            }
            $('#total-principal-rec').html(formatter.format(total));
        }
    }

    $("#filterinterests").submit(function (e) {
        e.preventDefault();

        let start = $("#filterintereststart").val(),
            end = $("#filterinterestend").val(),
            officer = $('#interest-officers').find('option:selected').attr('id')
            url = '/user/interests?start='+formatDate(start)+'&&end='+formatDate(end);
        if (start && end && officer==0){
            url = '/user/interests?start='+formatDate(start)+'&&end='+formatDate(end);
        }
        if ((!start || !end) && officer==0 ) {
            return loadInterestReceived();
        }
        if (officer != 0){
            url = url.concat('&&officer='+officer);
        }

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateInterestReceived(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    $("#filterinterestsrec").submit(function (e) {
        e.preventDefault();

        let start = $("#filterinterestrecstart").val(),
            end = $("#filterinterestrecend").val(),
            officer = $('#interest-rec-officers').find('option:selected').attr('id')
        url = '/user/interests-receivable?start='+formatDate(start)+'&&end='+formatDate(end);
        if (start && end && officer==0){
            url = '/user/interests-receivable?start='+formatDate(start)+'&&end='+formatDate(end);
        }
        if ((!start || !end) && officer==0 ) {
            return loadInterestReceivable();
        }
        if (officer != 0){
            url = url.concat('&&officer='+officer);
        }

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateInterestReceivable(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    $("#filterprincipal").submit(function (e) {
        e.preventDefault();

        let start = $("#filterprincipalstart").val(),
            end = $("#filterprincipal").val(),
            officer = $('#principal-officers').find('option:selected').attr('id')
        url = '/user/principal?start='+formatDate(start)+'&&end='+formatDate(end);
        if (start && end && officer==0){
            url = '/user/principal?start='+formatDate(start)+'&&end='+formatDate(end);
        }
        if ((!start || !end) && officer==0 ) {
            return loadPrincipalReceived();
        }
        if (officer != 0){
            url = url.concat('&&officer='+officer);
        }

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populatePrincipalReceived(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    $("#filterprincipalrec").submit(function (e) {
        e.preventDefault();

        let start = $("#filterprincipalrecstart").val(),
            end = $("#filterprincipalrecend").val(),
            officer = $('#principal-rec-officers').find('option:selected').attr('id')
        url = '/user/principal-receivable?start='+formatDate(start)+'&&end='+formatDate(end);
        if (start && end && officer==0){
            url = '/user/principal-receivable?start='+formatDate(start)+'&&end='+formatDate(end);
        }
        if ((!start || !end) && officer==0 ) {
            return loadPrincipalReceivable();
        }
        if (officer != 0){
            url = url.concat('&&officer='+officer);
        }

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populatePrincipalReceivable(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadBadLoans(){
//        let start = $("#filterbadloanstart").val(),
//            end = $("#filterbadloanend").val(),
//            url;
//        url = (start === "" || start === null || end === "" || end === null ) ? 'user/overdues' : 'user/overdues?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': 'user/badloans',
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateBadLoans(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function populateBadLoans(dets){
        $("#bad-loans-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#bad-loans-table").dataTable().fnClearTable();
            $('#total-badloans').html(formatter.format(0));
        }else{
            let deta = [];
            let num = dets.length;
            var total = 0;
            var oneDay = 24*60*60*1000; // hours*minutes*seconds*milliseconds
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1;
            var yyyy = today.getFullYear();
            var now = yyyy+'-'+mm+'-'+dd;
            now = new Date(now);
//            var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime())/(oneDay)));
            for (let i = 0; i < num; i++) {
                let v = dets[i];
                var duedate = new Date(v.duedate);
//                if ((Math.round((now.getTime() - duedate.getTime())/(oneDay))) > 90){
                let validpayment = amount_paid[v.applicationID];
                total += (v.principal - validpayment) ? parseFloat(v.principal - validpayment) : 0;
                v.id = '<a href="/application?id='+v.applicationID+'">'+padWithZeroes(parseInt(v.applicationID), 6)+'</a>';
                v.amount = (v.principal) ? formatter.format(parseFloat(v.principal)) : formatter.format(0);
                v.owed = (v.principal - validpayment) ? formatter.format(parseFloat(v.principal - validpayment)) : formatter.format(0);
                deta.push(v);
                if (i === num - 1) {
                    $('#bad-loans-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: deta,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            {data: "id"},
                            {data: "client"},
                            {data: "amount"},
                            {data: "owed"},
                            {data: "duedate"}
                        ]
                    });
                }
            }
//                }
            $('#total-badloans').html(formatter.format(total));
        }
    }

    $("#filterbadloans").submit(function (e) {
        e.preventDefault();

        let start = $("#filterbadloanstart").val(),
            end = $("#filterbadloanend").val(),
            url = '/user/overdues?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadBadLoans();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateBadLoans(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function loadOverdues(){
        let start = $("#filteroverduestart").val(),
            end = $("#filteroverdueend").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/overdues' : 'user/overdues?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                (data.status === 200) ? populateOverdues(data.response) : swal({"icon": "error", "text": 'Database Error'})
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

//    function populateOverdues(dets){
//        $("#overdues-table").dataTable().fnClearTable();
//        if (dets.length === 0){
//            $("#overdues-table").dataTable().fnClearTable();
//            $('#total-overdue').html(formatter.format(0));
//        }else{
//            var total = 0;
//            var today = new Date();
//            var dd = today.getDate();
//            var mm = today.getMonth()+1;
//            var yyyy = today.getFullYear();
//            var now = yyyy+'-'+mm+'-'+dd;
//            jQuery.each(dets, function(k, v){
//                var ddate = new Date(v.duedate);
//                now = new Date(now);
//                if (ddate < now){
//                    total+= parseFloat(v.amount_due);
//                    $("#overdues-table").dataTable().fnAddData([
//                        padWithZeroes(parseInt(v.applicationID),6),
//                        v.client,
//                        formatter.format(parseFloat(v.principal)),
//                        formatter.format(parseFloat(v.amount_due)),
//                        formatter.format(parseFloat(v.interest_due))
//                    ]);
//                }
//            });
//            $('#total-overdue').html(formatter.format(total));
//        }
//    }

    function populateOverdues(dets){
        $("#overdues-table").dataTable().fnClearTable();
        if (dets.length === 0){
            $("#overdues-table").dataTable().fnClearTable();
            $('#total-overdue').html(formatter.format(0));
        }else{
            let deta = [];
            let num = dets.length;
            var total = 0;
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1;
            var yyyy = today.getFullYear();
            var now = yyyy+'-'+mm+'-'+dd;
            for (let i = 0; i < num; i++){
                let v = dets[i];
                total+= parseFloat(v.amount_due);
                v.id = padWithZeroes(parseInt(v.applicationID),6);
                v.amount = formatter.format(parseFloat(v.principal));
                v.owed = formatter.format(parseFloat(v.amount_due));
                v.int_owed = formatter.format(parseFloat(v.interest_due));

                deta.push(v);
                if (i === num - 1) {
                    $('#overdues-table').DataTable({
                        dom: 'Blfrtip',
                        bDestroy: true,
                        data: deta,
                        search: {search: ' '},
                        buttons: [
                            'copy', 'csv', 'excel', 'pdf', 'print'
                        ],
                        columns: [
                            {data: "id"},
                            {data: "client"},
                            {data: "amount"},
                            {data: "owed"},
                            {data: "int_owed"},
                            {data: "payment_collect_date"},
                            {data: "days_since"}
                        ]
                    });
                }
            }
            $('#total-overdue').html(formatter.format(total));
        }
    }

    $("#filteroverdueloans").submit(function (e) {
        e.preventDefault();

        let start = $("#filteroverduestart").val(),
            end = $("#filteroverdueend").val(),
            url = '/user/overdues?start='+formatDate(start)+'&&end='+formatDate(end);
        if (!start || !end)
            return loadOverdues();

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateOverdues(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    });

    function formatDate(date) {
        if (!date)
            return '1970-01-01';
        let separator;
        if (date.indexOf('-') > -1){
            separator = '-';
        } else if (date.indexOf('/') > -1){
            separator = '/';
        } else {
            return date;
        }
        let date_array = date.split(separator);
        return date_array[0]+'-'+date_array[1]+'-'+date_array[2];
    }

    function getOfficers(){
        $.ajax({
            type: "GET",
            url: "/user/loan-officers/",
            data: '{}',
            success: function (response) {
                var role = $("[id=filter-officers]");
                role.empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#overdue-officers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#badloans-officers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#chartfilterofficers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#pchartfilterofficers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#irchartfilterofficers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#irrecchartfilterofficers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#interest-officers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#interest-rec-officers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#prchartfilterofficers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#prrecchartfilterofficers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#principal-officers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#principal-rec-officers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#pvifilterofficers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $("#filter-glp-officers").empty().append('<option value="0" id="0">All Loan Officers</option>');
                $.each(JSON.parse(response), function (key, val) {
                    $("#filter-officers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#overdue-officers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#badloans-officers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#chartfilterofficers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#pchartfilterofficers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#irchartfilterofficers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#irrecchartfilterofficers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#interest-officers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#interest-rec-officers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#prchartfilterofficers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#prrecchartfilterofficers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#principal-officers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#principal-rec-officers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#pvifilterofficers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                    $("#filter-glp-officers").append('<option value = "' + val.ID + '" id="' + val.ID + '">' + val.fullname + '</option>');
                });
            }
        });
    }

    function getLoanClasses(){
        $.ajax({
            type: "GET",
            url: "/user/classification-types/",
            data: '{}',
            success: function (response) {
                $("#loan-classes").empty().append('<option value="-1" id="-1">Choose Loan Classification</option>');
                $("#loan-classes").append('<option value="0" id="0">Performing Loans</option>');
                $.each(JSON.parse(response), function (key, val) {
                    let value = val.id+'-'+val.un_max;
                    $("#loan-classes").append('<option value = "' + value + '" id="' + val.id + '" un_max="'+val.un_max+'">' + val.description + '</option>');
                });
            }
        });
    }

    function filterOfficer(officer) {
        let urlAn = '/user/analytics?t=disbursements&&';
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url = '/user/disbursements-new/filter?',
            d=[], agent;
        if (start && end){
            url = url.concat('start='+formatDate(start)+'&&end='+formatDate(end)+'&&');
            urlAn = urlAn.concat('start='+formatDate(start)+'&&end='+formatDate(end)+'&&');
        }
        if (officer.value == 0){
            return loadDisbursed();
        }
        url = url.concat('officer='+officer.value);
        urlAn = urlAn.concat('officer='+officer.value);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateDisbursed(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

    function filterglpOfficer(officer){
        let start = $("#startGLPDate").val(),
            end = $("#endGLPDate").val(),
            url = '/user/disbursements/filter?',
            d=[], agent;
        if (start && end){
            url = url.concat('start='+formatDate(start)+'&&end='+formatDate(end)+'&&');
        }
        if (officer.value == 0){
            return loadGLP();
        }
        url = url.concat('officer='+officer.value);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateGLP(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

    function intFilterOfficer(officer) {
        let start = $("#filterintereststart").val(),
            end = $("#filterinterestend").val(),
            url = '/user/interests?',
            d=[], agent;
        if (start && end){
            url = url.concat('start='+formatDate(start)+'&&end='+formatDate(end)+'&&');
        }
        if (officer.value == 0){
            return loadInterestReceived();
        }
        url = url.concat('officer='+officer.value);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateInterestReceived(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

    function intRecFilterOfficer(officer) {
        let start = $("#filterinterestrecstart").val(),
            end = $("#filterinterestrecend").val(),
            url = '/user/interests-receivable?',
            d=[], agent;
        if (start && end){
            url = url.concat('start='+formatDate(start)+'&&end='+formatDate(end)+'&&');
        }
        if (officer.value == 0){
            return loadInterestReceived();
        }
        url = url.concat('officer='+officer.value);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateInterestReceivable(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

    function principalFilterOfficer(officer) {
        let start = $("#filterprincipalstart").val(),
            end = $("#filterprincipalend").val(),
            url = '/user/principal?',
            d=[], agent;
        if (start && end){
            url = url.concat('start='+formatDate(start)+'&&end='+formatDate(end)+'&&');
        }
        if (officer.value == 0){
            return loadPrincipalReceived();
        }
        url = url.concat('officer='+officer.value);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populatePrincipalReceived(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

    function principalRecFilterOfficer(officer) {
        let start = $("#filterprincipalrecstart").val(),
            end = $("#filterprincipalrecend").val(),
            url = '/user/principal-receivable?',
            d=[], agent;
        if (start && end){
            url = url.concat('start='+formatDate(start)+'&&end='+formatDate(end)+'&&');
        }
        if (officer.value == 0){
            return loadPrincipalReceived();
        }
        url = url.concat('officer='+officer.value);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populatePrincipalReceivable(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

//    function blfilterOfficer(officer) {
//        let start = $("#startDate").val(),
//            end = $("#endDate").val(),
//            url = '/user/badloans?',
//            d=[], agent;
//        if (officer.value == 0){
//            return loadBadLoans();
//        }
//        url = url.concat('officer='+officer.value);
//
//        $.ajax({
//            'url': url,
//            'type': 'get',
//            'success': function (data) {
//                let applications = data.response;
//                results = applications;
//                populateBadLoans(applications);
//            },
//            'error': function (err) {
//                console.log(err);
//            }
//        });
//    }

    function blfilterOfficer(officer) {
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url = '/user/badloans?',
            classification = $('#loan-classes').val().split('-')[0],
            unmax = $('#loan-classes').val().split('-')[1] ;
        let off_ = classification.value.split('-')[0];
        if (officer.value == 0 && classification == -1){
            return loadBadLoans();
        }
        else {
            url = '/user/badloanss?class='+classification+'&&';
        }
        url = url.concat('officer='+officer.value);
        url = url.concat('&&unmax='+unmax);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateBadLoans(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

    function loanclassFilter(classification){
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            officer = $('#badloans-officers').val(),
//            unmax = $('#loan-classes').attr('un_max') ;
            url = '/user/badloans?';
        let class_ = classification.value.split('-')[0],
            unmax = classification.value.split('-')[1] ;
        if (class_ == -1 && officer == 0){
            return loadBadLoans();
        }
        else {
            url = '/user/badloanss?class='+class_+'&&';
        }
        url = url.concat('officer='+officer);
        url = url.concat('&&unmax='+unmax);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateBadLoans(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

    function odfilterOfficer(officer) {
        let start = $("#filteroverduestart").val(),
            end = $("#filteroverdueend").val(),
            url = '/user/overdues?',
            d=[], agent;
        if (start && end){
            url = url.concat('start='+formatDate(start)+'&&end='+formatDate(end)+'&&');
        }
        if (officer.value == 0){
            return loadOverdues();
        }
        url = url.concat('officer='+officer.value);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                let applications = data.response;
                results = applications;
                populateOverdues(applications);
            },
            'error': function (err) {
                console.log(err);
            }
        });
    }

    ///Disbursement Chart & Filters

    function disbursed(){
        let d = [];
        let data = [
            {
                "label": "Venezuela",
                "value": "290"
            }, {
                "label": "Saudi",
                "value": "260"
            }, {
                "label": "Canada",
                "value": "180"
            }, {
                "label": "Iran",
                "value": "140"
            }, {
                "label": "Russia",
                "value": "115"
            }, {
                "label": "UAE",
                "value": "100"
            }, {
                "label": "US",
                "value": "30"
            }, {
                "label": "China",
                "value": "30"
            }];
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements/filter' : 'user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': 'user/analytics?t=disbursements',
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    d.push({label: v.name , value: v.amount_disbursed}, );
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Disbursements by Loan Officer(s)",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Loan Officers",
                            "yAxisName": "Amount Disbursed (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#chart-container").insertFusionCharts(chartConfigs);
//                loadDisbursed();
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function dFilterOfficer(officer){
        let url = '/user/analytics?t=disbursements&&',
            freq = $('#disburse-frequency').val(),
            year = $('#disburse-year').val();
        if (officer.value == 0 && freq == "-1"){
            return disbursed();
        }
        url = url.concat('officer='+officer.value+'&&year='+year);
        if (freq !== "-1"){
            url = url.concat('&&freq='+freq);
        }
        let d = [], categories = [], agent, xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.name){
                        agent = '';
                        d.push({label: v.name , value: v.amount_disbursed}, );
                    }
                    if (v.agent){
                        agent = ': '+v.agent;
                        d.push({label: v.agent , value: v.AmountDisbursed}, );
                    }
                    if (v.DisburseYear){
                        agent = ': '+v.Agent;
                        xaxis = 'Years';
                        d.push({label: v.DisburseYear , value: v.AmountDisbursed}, );
                    }
                    if (v.Year){
                        agent = ': '+v.Agent;
                        xaxis = 'Months';
                        d.push({label: v.DisburseMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficersYear , value: v.AmountDisbursed}, );
                    }
                    if (v.OfficersMonth){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.OfficersMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.AYear){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.Month , value: v.AmountDisbursed}, )
                    }
                    if (v.quarter){
                        agent = ': '+v.Agent;
                        xaxis = 'Quarters';
                        d.push({label: v.quarter , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.OfficersQuarter , value: v.AmountDisbursed}, )
                    }
                    if (v.AQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.AQuarter , value: v.AmountDisbursed}, )
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Disbursements by Loan Officer(s)"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount Disbursed (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#chart-container").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function dFrequencyChange(frequency){
        let url ='user/analytics?t=disbursements&&',
        year = $('#disburse-year').val(),
        officer = $('#chartfilterofficers').val();
        if (frequency.value == 2 || frequency.value == 4){
            $('#dis-year').show();
            if (officer && year){
                url = url.concat('officer='+officer+'&&year='+year+'&&freq='+frequency.value);
            }
        }
//        if (frequency.value == 3){
        else{
            $('#dis-year').hide();
            url = url.concat('officer='+officer+'&&freq='+frequency.value+'')
        }
        let d = [], categories = [], agent, xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.name){
                        agent = '';
                        d.push({label: v.name , value: v.amount_disbursed}, );
                    }
                    if (v.agent){
                        agent = ': '+v.agent;
                        d.push({label: v.agent , value: v.AmountDisbursed}, );
                    }
                    if (v.DisburseYear){
                        agent = ': '+v.Agent;
                        xaxis = 'Years'
                        d.push({label: v.DisburseYear , value: v.AmountDisbursed}, );
                    }
                    if (v.Year){
                        agent = ': '+v.Agent;
                        xaxis = 'Months';
                        d.push({label: v.DisburseMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficersYear , value: v.AmountDisbursed}, );
                    }
                    if (v.OfficersMonth){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.OfficersMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.AYear){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.Month , value: v.AmountDisbursed}, )
                    }
                    if (v.quarter){
                        agent = ': '+v.Agent;
                        xaxis = 'Quarters';
                        d.push({label: v.quarter , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.OfficersQuarter , value: v.AmountDisbursed}, )
                    }
                    if (v.AQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.AQuarter , value: v.AmountDisbursed}, )
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Disbursements by Loan Officer(s)"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount Disbursed (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#chart-container").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function dFilterYear(year) {
        let urlAn = '/user/analytics?t=disbursements&&';
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            officer = $('#chartfilterofficers').val(),
            freq = $('#disburse-frequency').val(),
            url = '/user/disbursements/filter?',
            d=[], agent, xaxis;
        url = url.concat('officer='+officer);
        urlAn = urlAn.concat('freq='+freq+'&&officer='+officer+'&&year='+year.value);

        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.name){
                        agent = '';
                        d.push({label: v.name , value: v.amount_disbursed}, );
                    }
                    if (v.agent){
                        agent = ': '+v.agent;
                        d.push({label: v.agent , value: v.AmountDisbursed}, );
                    }
                    if (v.DisburseYear){
                        agent = ': '+v.Agent;
                        xaxis = 'Years'
                        d.push({label: v.DisburseYear , value: v.AmountDisbursed}, );
                    }
                    if (v.Year){
                        agent = ': '+v.Agent;
                        xaxis = 'Months';
                        d.push({label: v.DisburseMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficersYear , value: v.AmountDisbursed}, );
                    }
                    if (v.OfficersMonth){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.OfficersMonth , value: v.AmountDisbursed}, )
                    }
                    if (v.AYear){
                        agent = '';
                        xaxis = 'Months';
                        d.push({label: v.Month , value: v.AmountDisbursed}, )
                    }
                    if (v.quarter){
                        agent = ': '+v.Agent;
                        xaxis = 'Quarters';
                        d.push({label: v.quarter , value: v.AmountDisbursed}, )
                    }
                    if (v.OfficersQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.OfficersQuarter , value: v.AmountDisbursed}, )
                    }
                    if (v.AQuarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.AQuarter , value: v.AmountDisbursed}, )
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Disbursements by Loan Officer(s)"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount Disbursed (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#chart-container").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    // Loans By Branch Chart & Filters

    function getBranches(){
        $.ajax({
            type: "GET",
            url: "/user/branches/",
            success: function (response) {
                $("#chartfilterbranches").empty().append('<option id="0" value ="0">Select a Branch</option>');
                $.each(JSON.parse(response), function (key, val) {
                    $("#chartfilterbranches").append('<option value = "' + val.id + '" id="' + val.id + '">' + val.branch_name + '</option>');
                });
            }
        });
    }

    function branches(type){
        let d = [], url, report = $('#reportview').val();
        url = ($('#reportview').val() == '1') ? 'user/analytics?t=branches&&bt='+type : 'user/multi-analytics?t=branches&&bt='+type;
        let start = $("#startDate").val(),
            end = $("#endDate").val();
        let yaxis, caption;
        let c = [], dataset = [];
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    let value;
                    if (v.amount_disbursed)
                        value = v.amount_disbursed;
                    if (v.amount_received)
                        value = v.amount_received;
                    if (v.amount)
                        value = v.amount;
                    d.push({label: v.branch , value: value}, );
                });
                if (type == '1'){
                    yaxis = 'Amount Disbursed (In Naira)';
                    caption = 'Disbursements by Branches'
                }
                if (type == '2'){
                    yaxis = 'Interest Earned (In Naira)';
                    caption = 'Interest Earned by Branches'
                }
                if (type == '3'){
                    yaxis = 'Payments Received (In Naira)';
                    caption = 'Payments Received by Branches'
                }
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": caption,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Branches",
                            "yAxisName": yaxis,
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#branch-chart").insertFusionCharts(chartConfigs);
//                loadLoansByBranch();
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function bFilterBranch(branch){
        let url = '/user/analytics?t=branches&&bt='+$('#branchreport').val()+'&&',
            freq = $('#branch-frequency').val(),
            year = $('#branch-year').val();
        if (branch.value == 0){
            swal('', 'You have to choose a branch to continue!', 'warning');
            $('#branch-frequency').val(-1);
            $('#branch-year').val(0);
            $('#brn-year').hide();
            return branches($('#branchreport').val());
        }
        url = url.concat('branch='+branch.value+'&&year='+year);
        if (freq != "2" || freq != '4'){
            $('#brn-year').hide();
            $('#branch-year').val(0);
            url = url.concat('&&freq='+freq);
        }
        else {
            url = url.concat('&&freq='+freq);
        }
        let d = [], agent = '', xaxis, yaxis, caption, categories = [], dataset = [];

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if ($('#branchreport').val() == '1'){
                        yaxis = "Amount Disbursed (Naira)";
                        caption = 'Disbursements by Branches';
                        if (v.branch)
                            d.push({label: v.branch , value: v.amount_disbursed}, );
                        if (v.year){
                            agent = ': '+v.office;
                            xaxis = 'Years'
                            d.push({label: v.year , value: v.AmountDisbursed}, );
                        }
                        if (v.month){
                            agent = ': '+v.office;
                            xaxis = 'Months';
                            d.push({label: v.DisburseMonth , value: v.AmountDisbursed}, )
                        }
                        if (v.Quarter){
                            agent = ': '+v.office;
                            xaxis = 'Quarters'
                            d.push({label: v.Quarter , value: v.AmountDisbursed}, );
                        }
                    }
                    if ($('#branchreport').val() == '2'){
                        yaxis = 'Interest Earned (Naira)';
                        caption = 'Interest Earned by Branches: ';
                        if (v.branch)
                            d.push({label: v.branch , value: v.amount_received}, );
                        if (v.PaymentYear){
                            agent = ': '+v.office;
                            xaxis = 'Period'
                            d.push({label: v.PaymentYear , value: v.amount_received}, );
                        }
                        if (v.monthpayed){
                            agent = ': '+v.office;
                            xaxis = 'Period';
                            d.push({label: v.monthpayed , value: v.amount_received}, )
                        }
                        if (v.branchQuarter){
                            agent = ': '+v.office;
                            xaxis = 'Period'
                            d.push({label: v.branchQuarter , value: v.amount_received}, );
                        }
                    }
                    if ($('#branchreport').val() == '3'){
                        yaxis = 'Payments Received (Naira)';
                        caption = 'Payments Received by Branches ';
                        if (v.branch) {
                            agent = ': '+v.branch;
                            d.push({label: v.branch, value: v.amount_received},);
                        }
                        if (v.PaymentYear){
                            agent = ': '+v.office;
                            xaxis = 'Period'
                            d.push({label: v.PaymentYear , value: v.amount_received}, );
                        }
                        if (v.monthpayed){
                            agent = ': '+v.office;
                            xaxis = 'Period';
                            d.push({label: v.monthpayed , value: v.amount_received}, )
                        }
                        if (v.branchQuarter){
                            agent = ': '+v.office;
                            xaxis = 'Period'
                            d.push({label: v.branchQuarter , value: v.amount_received}, );
                        }
                    }
                    if ($('#branchreport').val() == '4'){
                        xaxis = '';
                        yaxis = 'Badloans (Naira)';
                        caption = 'Badloans by Branches ';
                        agent = ': '+v.branch;
                        d.push({label: v.branch, value: v.amount},);
                        if (v.period)
                            xaxis = 'Period';
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": caption+''+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": yaxis,
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#branch-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

//    function bFrequencyChange(frequency){
//        let url = ($('#reportview').val() == '1') ? 'user/analytics?t=branches&&bt='+$('#branchreport').val()+'&&' : 'user/multi-analytics?bt='+$('#branchreport').val()+'&&';
//            year = $('#branch-year').val(), report = $('#reportview').val(),
//            branch = $('#chartfilterbranches').val();
////        if (branch == 0){
////            return swal('Please select a branch!', '','warning');
////        }
//        if (frequency.value == 2 || frequency.value == 4){
//            $('#brn-year').show();
//            if (branch && year){
//                url = url.concat('branch='+branch+'&&year='+year+'&&freq='+frequency.value);
//            }
//        }
//        else {
//            $('#brn-year').hide();
//            url = url.concat('branch='+branch+'&&freq='+frequency.value);
//        }
//        let d = [], agent = '', xaxis, yaxis, caption, categories = [], dataset = [];
//
//        $.ajax({
//            'url': url,
//            'type': 'get',
//            'success': function (data) {
////                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
//                if (report == '1'){
//                    jQuery.each(data.response, function(k, v){
//                        if ($('#branchreport').val() == '1') {
//                            yaxis = "Amount Disbursed (Naira)";
//                            caption = 'Disbursements by Branches: ';
//                            if (v.branch)
//                                d.push({label: v.name, value: v.amount_disbursed},);
//                            if (v.year) {
//                                agent = ': ' + v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.year, value: v.AmountDisbursed},);
//                            }
//                            if (v.month) {
//                                agent = ': ' + v.branch;
//                                xaxis = 'Months';
//                                d.push({label: v.DisburseMonth, value: v.AmountDisbursed},)
//                            }
//                            if (v.Quarter) {
//                                agent = ': ' + v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.Quarter, value: v.AmountDisbursed},);
//                            }
//                        }
//                        if ($('#branchreport').val() == '2'){
//                            yaxis = 'Interest Earned (Naira)';
//                            caption = 'Interest Earned by Branches: ';
//                            if (v.branch)
//                                d.push({label: v.branch , value: v.amount_received}, );
//                            if (v.PaymentYear){
//                                agent = ': '+v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.PaymentYear , value: v.amount_received}, );
//                            }
//                            if (v.monthpayed){
//                                agent = ': '+v.office;
//                                xaxis = 'Months';
//                                d.push({label: v.monthpayed , value: v.amount_received}, )
//                            }
//                            if (v.branchQuarter){
//                                agent = ': '+v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.branchQuarter , value: v.amount_received}, );
//                            }
//                        }
//                    });
//                    var chartConfigs = {
//                        type: 'column2d', // The chart type
//                        width: '100%', // Width of the chart
//                        height: '400', // Height of the chart
//                        dataFormat: 'json', // Data type
//                        dataSource: {
//                            // Chart Configuration
//                            "chart": {
//                                "caption": caption+''+agent,
////                            "subCaption": "In MMbbl = One Million barrels",
//                                "xAxisName": xaxis,
//                                "yAxisName": yaxis,
//                                "numberSuffix": " Naira",
//                                "theme": "fusion",
//                            },
//                            // Chart Data
//                            "data": d
//                        }
//                    };
//                }
//                else if (report == '2'){
//                    console.log(data.response)
//                    jQuery.each(data.response, function(k, v){
//                        if ($('#branchreport').val() == '1') {
//                            yaxis = "Amount Disbursed (Naira)";
//                            caption = 'Disbursements by Branches: ';
//                            if (v.branch)
//                                d.push({label: v.name, value: v.amount_disbursed},);
//                            if (v.year) {
//                                agent = ': ' + v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.year, value: v.AmountDisbursed},);
//                            }
//                            if (v.month) {
//                                agent = ': ' + v.branch;
//                                xaxis = 'Months';
//                                d.push({label: v.DisburseMonth, value: v.AmountDisbursed},)
//                            }
//                            if (v.Quarter) {
//                                agent = ': ' + v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.Quarter, value: v.AmountDisbursed},);
//                            }
//                        }
//                        if ($('#branchreport').val() == '2'){
//                            yaxis = 'Interest Earned (Naira)';
//                            caption = 'Interest Earned by Branches: ';
//                            if (v.branch)
//                                d.push({label: v.branch , value: v.amount_received}, );
//                            if (v.PaymentYear){
//                                agent = ': '+v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.PaymentYear , value: v.amount_received}, );
//                            }
//                            if (v.monthpayed){
//                                agent = ': '+v.office;
//                                xaxis = 'Months';
//                                d.push({label: v.monthpayed , value: v.amount_received}, )
//                            }
//                            if (v.branchQuarter){
//                                agent = ': '+v.office;
//                                xaxis = 'Years'
//                                d.push({label: v.branchQuarter , value: v.amount_received}, );
//                            }
//                        }
//                    });
//                    var chartConfigs = {
//                        type: 'mscolumn2d',
////                        renderAt: 'chart-container',
//                        width: '100%',
//                        height: '400',
//                        dataFormat: 'json',
//                        dataSource: {
//                            "chart": {
//                                "theme": "fusion",
//                                "caption": "Comparison of Branches",
//                                "xAxisname": "Quarter",
//                                "yAxisName": "Amount (In Naira)",
//                                "plotFillAlpha": "80",
//                                "divLineIsDashed": "1",
//                                "divLineDashLen": "1",
//                                "divLineGapLen": "1"
//                            },
//                            "categories": [{
//                                "category": [{
//                                    "label": "Q1"
//                                }, {
//                                    "label": "Q2"
//                                }, {
//                                    "label": "Q3"
//                                }, {
//                                    "label": "Q4"
//                                }]
//                            }],
//                            "dataset": [{
//                                "seriesname": "Previous Year",
//                                "data": [{
//                                    "value": "10000"
//                                }, {
//                                    "value": "11500"
//                                }, {
//                                    "value": "12500"
//                                }, {
//                                    "value": "15000"
//                                }]
//                            }, {
//                                "seriesname": "Current Year",
//                                "data": [{
//                                    "value": "25400"
//                                }, {
//                                    "value": "29800"
//                                }, {
//                                    "value": "21800"
//                                }, {
//                                    "value": "26800"
//                                }]
//                            }]
//                        }
//                    };
//                }
//                $("#branch-chart").insertFusionCharts(chartConfigs);
//            },
//            'error': function (err) {
//                swal('Error in Connection!','','error')
//            }
//        });
//    }

    function bFrequencyChange(frequency){
        let url = ($('#reportview').val() == '1') ? 'user/analytics?t=branches&&bt='+$('#branchreport').val()+'&&' : 'user/multi-analytics?bt='+$('#branchreport').val()+'&&';
        year = $('#branch-year').val(), report = $('#reportview').val(),
            branch = $('#chartfilterbranches').val();
        if (($('#reportview').val() == '1') && branch == 0){
            return swal('Please select a branch!', '','warning');
        }
        if (frequency.value == 2 || frequency.value == 4){
            $('#brn-year').show();
            if (branch && year){
                url = url.concat('branch='+branch+'&&year='+year+'&&freq='+frequency.value);
            }
        }
        else {
            $('#brn-year').hide();
            $('#branch-year').val(0);
            url = url.concat('branch='+branch+'&&freq='+frequency.value+'&&year='+$('#branch-year').val());
        }
        let d = [], series = '', agent = '', xaxis, yaxis, caption, categories = [], dataset = [], datar = [], chartTemp, values = [], diffSeries = [], countSeries, seriesNames = [], nondupSeriesNames = [];
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                // Single Branch
                if (report == '1'){
                    jQuery.each(data.response, function(k, v){
                        if ($('#branchreport').val() == '1') {
                            yaxis = "Amount Disbursed (Naira)";
                            caption = 'Disbursements by Branches';
                            if (v.branch)
                                d.push({label: v.branch, value: v.amount_disbursed},);
                            if (v.year) {
                                agent = ': ' + v.office;
                                xaxis = 'Years'
                                d.push({label: v.year, value: v.AmountDisbursed},);
                            }
                            if (v.month) {
                                agent = ': ' + v.office;
                                xaxis = 'Months';
                                d.push({label: v.DisburseMonth, value: v.AmountDisbursed},)
                            }
                            if (v.Quarter) {
                                agent = ': ' + v.office;
                                xaxis = 'Quarters'
                                d.push({label: v.Quarter, value: v.AmountDisbursed},);
                            }
                        }
                        if ($('#branchreport').val() == '2'){
                            yaxis = 'Interest Earned (Naira)';
                            caption = 'Interest Earned by Branches';
                            if (v.branch)
                                d.push({label: v.branch , value: v.amount_received}, );
                            if (v.PaymentYear){
                                agent = ': '+v.office;
                                xaxis = 'Years'
                                d.push({label: v.PaymentYear , value: v.amount_received}, );
                            }
                            if (v.monthpayed){
                                agent = ': '+v.office;
                                xaxis = 'Months';
                                d.push({label: v.monthpayed , value: v.amount_received}, )
                            }
                            if (v.branchQuarter){
                                agent = ': '+v.office;
                                xaxis = 'Quarters'
                                d.push({label: v.branchQuarter , value: v.amount_received}, );
                            }
                        }
                        if ($('#branchreport').val() == '3'){
                            yaxis = 'Payments Received (Naira)';
                            caption = 'Payments Received by Branches ';
                            if (v.branch) {
                                agent = ': '+v.branch;
                                d.push({label: v.branch, value: v.amount_received},);
                            }
                            if (v.PaymentYear){
                                agent = ': '+v.office;
                                xaxis = 'Period'
                                d.push({label: v.PaymentYear , value: v.amount_received}, );
                            }
                            if (v.monthpayed){
                                agent = ': '+v.office;
                                xaxis = 'Period';
                                d.push({label: v.monthpayed , value: v.amount_received}, )
                            }
                            if (v.branchQuarter){
                                agent = ': '+v.office;
                                xaxis = 'Period'
                                d.push({label: v.branchQuarter , value: v.amount_received}, );
                            }
                        }
                        if ($('#branchreport').val() == '4'){
                            xaxis = '';
                            yaxis = 'Badloans (Naira)';
                            caption = 'Badloans by Branches ';
                            agent = ': '+v.branch;
                            d.push({label: v.branch, value: v.amount},);
                            if (v.period)
                                xaxis = 'Period';
                        }
                    });
                    var chartConfigs = {
                        type: 'column2d', // The chart type
                        width: '100%', // Width of the chart
                        height: '400', // Height of the chart
                        dataFormat: 'json', // Data type
                        dataSource: {
                            // Chart Configuration
                            "chart": {
                                "caption": caption+''+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                                "xAxisName": xaxis,
                                "yAxisName": yaxis,
                                "numberSuffix": "",
                                "theme": "fusion",
                            },
                            // Chart Data
                            "data": d
                        }
                    };
                    $("#branch-chart").insertFusionCharts(chartConfigs);
                }
                // All Branches
                else if (report == '2'){
                    if ($('#branchreport').val() == '1') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = "Amount Disbursed (Naira)";
                            caption = 'Disbursements by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            console.log(chartTemp);
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.branch);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.branch === nondupSeriesNames[j];}))[0];
                                if (branch_series_value){
                                    datum.push({value: branch_series_value.AmountDisbursed});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    if ($('#branchreport').val() == '2') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = 'Interest Earned (Naira)';
                            caption = 'Interest Earned by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.office);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];
                                if (branch_series_value){
                                    datum.push({value: branch_series_value.amount_received});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    if ($('#branchreport').val() == '3') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = 'Payments Received (Naira)';
                            caption = 'Payments Received by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.office);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];
                                if (branch_series_value){
                                    datum.push({value: branch_series_value.amount_received});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    if ($('#branchreport').val() == '4') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = 'Badloans (Naira)';
                            caption = 'Badloans by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.office);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];

                                if (branch_series_value){
                                    datum.push({value: branch_series_value.amount_due});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    var dConfigs = {
                        type: 'mscolumn2d',
                        renderAt: 'chart-container',
                        width: '100%',
                        height: '400',
                        dataFormat: 'json',
                        dataSource: {
                            "chart": {
                                "theme": "fusion",
                                "caption": caption,
                                "xAxisname": 'Period',
                                "yAxisName": "Amount (In Naira)",
                                "plotFillAlpha": "80",
                                "divLineIsDashed": "1",
                                "divLineDashLen": "1",
                                "divLineGapLen": "1"
                            },
                            "categories": [{'category': categories}],
                            "dataset": dataset
                        }
                    };
                    $("#branch-chart").insertFusionCharts(dConfigs);
                }
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function bFilterYear(year) {
        let urlAn = ($('#reportview').val() == '1') ? '/user/analytics?t=branches&&bt='+$('#branchreport').val()+'&&' : 'user/multi-analytics?bt='+$('#branchreport').val()+'&&';
        let branch = $('#chartfilterbranches').val(), report = $('#reportview').val(),
            freq = $('#branch-frequency').val(),
            d=[], agent, xaxis, yaxis, caption, categories = [], dataset = [], datar = [], chartTemp, values = [], diffSeries = [], countSeries, seriesNames = [], nondupSeriesNames = [];
        if (($('#reportview').val() == '1') && branch == 0){
            return swal('Please choose a branch!', '', 'warning');
        }
        urlAn = urlAn.concat('freq='+freq+'&&branch='+branch+'&&year='+year.value);

        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
                if (report == '1'){
                    jQuery.each(data.response, function(k, v){
                        if ($('#branchreport').val() == '1') {
                            yaxis = 'Interest Earned (Naira)';
                            caption = 'Disbursements by Branches';
                            if (v.branch)
                                d.push({label: v.branch, value: v.amount_disbursed},);
                            if (v.year) {
                                agent = ': ' + v.office;
                                xaxis = 'Years'
                                d.push({label: v.DisburseYear, value: v.AmountDisbursed},);
                            }
                            if (v.month) {
                                agent = ': ' + v.office;
                                xaxis = 'Months';
                                d.push({label: v.DisburseMonth, value: v.AmountDisbursed},)
                            }
                            if (v.Quarter) {
                                agent = ': ' + v.office;
                                xaxis = 'Quarters'
                                d.push({label: v.Quarter, value: v.AmountDisbursed},);
                            }
                        }
                        if ($('#branchreport').val() == '2'){
                            yaxis = 'Interest Earned (Naira)';
                            caption = 'Interest Earned by Branches';
                            if (v.branch)
                                d.push({label: v.branch , value: v.amount_received}, );
                            if (v.PaymentYear){
                                agent = ': '+v.office;
                                xaxis = 'Years'
                                d.push({label: v.PaymentYear , value: v.amount_received}, );
                            }
                            if (v.monthpayed){
                                agent = ': '+v.office;
                                xaxis = 'Months';
                                d.push({label: v.monthpayed , value: v.amount_received}, )
                            }
                            if (v.branchQuarter){
                                agent = ': '+v.office;
                                xaxis = 'Quarters'
                                d.push({label: v.branchQuarter , value: v.amount_received}, );
                            }
                        }
                        if ($('#branchreport').val() == '3'){
                            yaxis = 'Payments Received (Naira)';
                            caption = 'Payments Received by Branches ';
                            if (v.branch) {
                                agent = ': '+v.branch;
                                d.push({label: v.branch, value: v.amount_received},);
                            }
                            if (v.PaymentYear){
                                agent = ': '+v.office;
                                xaxis = 'Period'
                                d.push({label: v.PaymentYear , value: v.amount_received}, );
                            }
                            if (v.monthpayed){
                                agent = ': '+v.office;
                                xaxis = 'Period';
                                d.push({label: v.monthpayed , value: v.amount_received}, )
                            }
                            if (v.branchQuarter){
                                agent = ': '+v.office;
                                xaxis = 'Period'
                                d.push({label: v.branchQuarter , value: v.amount_received}, );
                            }
                        }
                        if ($('#branchreport').val() == '4'){
                            xaxis = '';
                            yaxis = 'Badloans (Naira)';
                            caption = 'Badloans by Branches ';
                            agent = ': '+v.branch;
                            d.push({label: v.branch, value: v.amount},);
                            if (v.period)
                                xaxis = 'Period';
                        }
                    });
                    var chartConfigs = {
                        type: 'column2d', // The chart type
                        width: '100%', // Width of the chart
                        height: '400', // Height of the chart
                        dataFormat: 'json', // Data type
                        dataSource: {
                            // Chart Configuration
                            "chart": {
                                "caption": caption+''+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                                "xAxisName": xaxis,
                                "yAxisName": yaxis,
                                "numberSuffix": "",
                                "theme": "fusion",
                            },
                            // Chart Data
                            "data": d
                        }
                    };
                    $("#branch-chart").insertFusionCharts(chartConfigs);
                }
                else if (report == '2'){
                    if ($('#branchreport').val() == '1') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = "Amount Disbursed (Naira)";
                            caption = 'Disbursements by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.branch);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.branch === nondupSeriesNames[j];}))[0];
                                if (branch_series_value){
                                    datum.push({value: branch_series_value.AmountDisbursed});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    if ($('#branchreport').val() == '2') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = 'Interest Earned (Naira)';
                            caption = 'Interest Earned by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.office);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];
                                if (branch_series_value){
                                    datum.push({value: branch_series_value.amount_received});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    if ($('#branchreport').val() == '3') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = 'Payments Received (Naira)';
                            caption = 'Payments Received by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.office);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];
                                if (branch_series_value){
                                    datum.push({value: branch_series_value.amount_received});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    if ($('#branchreport').val() == '4') {
                        jQuery.each(data.response, function (k, v) {
                            yaxis = 'Badloans (Naira)';
                            caption = 'Badloans by Branches';
                            xaxis = 'Period';
                            categories.push({label: k});
                            chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                            values.push(chartTemp);
                            diffSeries.push(chartTemp.length);
                            jQuery.each(v, function (key, val) {
                                seriesNames.push(val.office);
                            });
                        });
                        countSeries = Math.max.apply(Math, diffSeries);
                        nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                            return index === self.indexOf(elem);
                        }).sort();
                        for (let j = 0; j < nondupSeriesNames.length; j++) {
                            let datum = [];
                            for (let i = 0; i < values.length; i++) {
                                let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];
                                if (branch_series_value){
                                    datum.push({value: branch_series_value.amount_due});
                                } else {
                                    datum.push({value: 0});
                                }
                            }
                            dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                        }
                    }
                    var dConfigs = {
                        type: 'mscolumn2d',
                        renderAt: 'chart-container',
                        width: '100%',
                        height: '400',
                        dataFormat: 'json',
                        dataSource: {
                            "chart": {
                                "theme": "fusion",
                                "caption": caption,
                                "xAxisname": 'Period',
                                "yAxisName": "Amount (In Naira)",
                                "plotFillAlpha": "80",
                                "divLineIsDashed": "1",
                                "divLineDashLen": "1",
                                "divLineGapLen": "1"
                            },
                            "categories": [{'category': categories}],
                            "dataset": dataset
                        }
                    };
                    $("#branch-chart").insertFusionCharts(dConfigs);
                }
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function changereport(type){
        $('#chartfilterbranches').val(0);
        $('#branch-frequency').val(-1);
        $('#branch-year').val(0);
        $('#brn-year').hide();
        if (type.value === '1'){//Disbursements
            $('#div-disbursement').show();
            $('#div-interest').hide();
            $('#div-payment').hide();
            $('#div-badloan').hide();
        }
        if (type.value == '2'){//Interest
            $('#div-disbursement').hide();
            $('#div-interest').show();
            $('#div-payment').hide();
            $('#div-badloan').hide();
            loadInterestsByBranch();
        }
        if (type.value == '3'){//Payments
            $('#div-disbursement').hide();
            $('#div-interest').hide();
            $('#div-payment').show()
            $('#div-badloan').hide();
            loadPaymentsByBranch();
        }
        if (type.value == '4'){//Payments
            $('#div-disbursement').hide();
            $('#div-interest').hide();
            $('#div-payment').hide();
            $('#div-badloan').show();
            loadBadloansByBranch();
        }
        return branches(type.value);
    }

    function changeview(type){
        if (type.value == '1'){
            $('#sel-brn').show();
        }else{
            $('#sel-brn').hide();
        }
    }

    // Payments

    function payments(){
        let d = [];
        let data = [
            {
                "label": "Venezuela",
                "value": "290"
            }, {
                "label": "Saudi",
                "value": "260"
            }, {
                "label": "Canada",
                "value": "180"
            }, {
                "label": "Iran",
                "value": "140"
            }, {
                "label": "Russia",
                "value": "115"
            }, {
                "label": "UAE",
                "value": "100"
            }, {
                "label": "US",
                "value": "30"
            }, {
                "label": "China",
                "value": "30"
            }];
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements/filter' : 'user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': 'user/analytics?t=payments',
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    d.push({label: v.officer , value: v.amount_payed}, );
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Payments Received",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Loan Officers",
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#payments-chart").insertFusionCharts(chartConfigs);
//                loadPayments();
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });

    }

    function pFilterOfficer(officer){
        let url = '/user/analytics?t=payments&&',
            freq = $('#payment-frequency').val(),
            year = $('#payment-year').val();
        if (officer.value == 0){
            $('#payment-frequency').val(-1);
            $('#payment-year').val(0);
            $('#pay-year').hide();
            return payments();
        }
        url = url.concat('officer='+officer.value+'&&year='+year);
        if (freq != "2" || freq != '4'){
            $('#pay-year').hide();
            $('#payment-year').val(0);
            url = url.concat('&&freq='+freq);
        }
        else {
            url = url.concat('&&freq='+freq);
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.AmountPayed}, );
                    }
                    if (v.year){
                        agent = ': '+v.name;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.AmountPayed}, );
                    }
                    if (v.Officersmonth){
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.month){
                        agent = ': '+v.name;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.allpaymentyear){
                        agent = '';
                        d.push({label: v.allpaymentyear , value: v.AmountPayed}, );
                    }
                    if (v.Quarter){
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.AmountPayed}, );
                    }
                    if (v.Officersquarter){
                        agent = ': '+v.name;
                        xaxis = 'Quarters';
                        d.push({label: v.Officersquarter , value: v.AmountPayed}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Payments Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#payments-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function pFrequencyChange(frequency){
        let url ='user/analytics?t=payments&&',
            year = $('#payment-year').val(),
            officer = $('#pchartfilterofficers').val();
        if (frequency.value == 2 || frequency.value == 4){
            $('#pay-year').show();
            if (officer && year){
                url = url.concat('officer='+officer+'&&year='+year+'&&freq='+frequency.value);
            }
        }
        else {
            $('#pay-year').hide();
            $('#payment-year').val(0);
            url = url.concat('officer='+officer+'&&freq='+frequency.value+'&&year='+$('#payment-year').val());
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.AmountPayed}, );
                    }
                    if (v.year){
                        agent = ': '+v.name;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.AmountPayed}, );
                    }
                    if (v.Officersmonth){
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.month){
                        agent = ': '+v.name;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.allpaymentyear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.allpaymentyear , value: v.AmountPayed}, );
                    }
                    if (v.Quarter){
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.AmountPayed}, );
                    }
                    if (v.Officersquarter){
                        agent = ': '+v.name;
                        xaxis = 'Quarters';
                        d.push({label: v.Officersquarter , value: v.AmountPayed}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Payments Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#payments-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function pFilterYear(year) {
        let urlAn = '/user/analytics?t=payments&&';
        let officer = $('#pchartfilterofficers').val(),
            freq = $('#payment-frequency').val(),
            d=[], agent = '', xaxis;
        urlAn = urlAn.concat('freq='+freq+'&&officer='+officer+'&&year='+year.value);

        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.AmountPayed}, );
                    }
                    if (v.year){
                        agent = ': '+v.name;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.AmountPayed}, );
                    }
                    if (v.Officersmonth){
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.month){
                        agent = ': '+v.name;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.AmountPayed}, )
                    }
                    if (v.allpaymentyear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.allpaymentyear , value: v.AmountPayed}, );
                    }
                    if (v.Quarter){
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.AmountPayed}, );
                    }
                    if (v.Officersquarter){
                        agent = ': '+v.name;
                        xaxis = 'Quarters';
                        d.push({label: v.Officersquarter , value: v.AmountPayed}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Payments Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#payments-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    // Interests Received

    function interestreceived(){
        let d = [];
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements/filter' : 'user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': 'user/analytics?t=interest-received',
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    d.push({label: v.officer , value: v.amount_received}, );
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Received",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Loan Officers",
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-received-chart").insertFusionCharts(chartConfigs);
//                loadInterestReceived();
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });

    }

    function irFilterOfficer(officer){
        let url = '/user/analytics?t=interest-received&&',
            freq = $('#ir-frequency').val(),
            year = $('#i-r-year').val();
        if (officer.value == 0 && freq == "-1"){
            return interestreceived();
        }
        url = url.concat('officer='+officer.value+'&&year='+year);
        if (freq != "2" || freq != '4'){
            $('#ir-year').hide();
            $('#i-r-year').val(0);
            url = url.concat('&&freq='+freq);
        }
        else{
            url = url.concat('&&freq='+freq);
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_received}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_received}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_received}, )
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_received}, )
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_received}, )
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Period';
                        d.push({label: v.OfficerQuarter , value: v.amount_received}, )
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_received}, )
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_received}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_received}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-received-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function irFrequencyChange(frequency){
        let url ='user/analytics?t=interest-received&&',
            year = $('#i-r-year').val(),
            officer = $('#irchartfilterofficers').val();
        if (frequency.value == 2 || frequency.value == 4){
            $('#ir-year').show();
            if (officer && year){
                url = url.concat('officer='+officer+'&&year='+year+'&&freq='+frequency.value);
            }
        }
        else {
            $('#ir-year').hide();
            $('#i-r-year').val(0);
            url = url.concat('officer='+officer+'&&freq='+frequency.value+'&&year='+$('#i-r-year').val());
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_received}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_received}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_received}, )
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_received}, )
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_received}, )
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Quarters';
                        d.push({label: v.OfficerQuarter , value: v.amount_received}, )
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_received}, )
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_received}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_received}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-received-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function irFilterYear(year) {
        let urlAn = '/user/analytics?t=interest-received&&';
        let officer = $('#irchartfilterofficers').val(),
            freq = $("#ir-frequency").val(),
            d=[], agent, xaxis;
        urlAn = urlAn.concat('freq='+freq+'&&officer='+officer+'&&year='+year.value);

        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_received}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_received}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_received}, );
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_received}, );
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_received}, );
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Quarters';
                        d.push({label: v.OfficerQuarter , value: v.amount_received}, );
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_received}, );
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_received}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_received}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-received-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    // Interests Receivable

    function interestreceivable(){
        let d = [];

        $.ajax({
            'url': 'user/analytics?t=interest-receivable',
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    d.push({label: v.officer , value: v.amount_due}, );
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Receivable",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Loan Officers",
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-receivable-chart").insertFusionCharts(chartConfigs);
//                loadInterestReceivable();
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });

    }

    function irRecFilterOfficer(officer){
        let url = '/user/analytics?t=interest-receivable&&',
            freq = $('#ir-rec-frequency').val(),
            year = $('#i-r-rec-year').val();
        if (officer.value == 0 && freq == "-1"){
            return interestreceivable();
        }
        url = url.concat('officer='+officer.value+'&&year='+year);
        if (freq != "2" || freq != '4'){
            $('#ir-rec-year').hide();
            $('#i-r-rec-year').val(0);
            url = url.concat('&&freq='+freq);
        }
        else{
            url = url.concat('&&freq='+freq);
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_due}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_due}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_due}, )
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_due}, )
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_due}, )
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Period';
                        d.push({label: v.OfficerQuarter , value: v.amount_due}, )
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_due}, )
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_due}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_due}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Receivable"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-receivable-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function irRecFrequencyChange(frequency){
        let url ='user/analytics?t=interest-receivable&&',
            year = $('#i-r-rec-year').val(),
            officer = $('#irrecchartfilterofficers').val();
        if (frequency.value == 2 || frequency.value == 4){
            $('#ir-rec-year').show();
            if (officer && year){
                url = url.concat('officer='+officer+'&&year='+year+'&&freq='+frequency.value);
            }
        }
        else {
            $('#ir-rec-year').hide();
            $('#i-r-rec-year').val(0);
            url = url.concat('officer='+officer+'&&freq='+frequency.value+'&&year='+$('#i-r-rec-year').val());
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_due}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_due}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_due}, )
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_due}, )
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_due}, )
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Quarters';
                        d.push({label: v.OfficerQuarter , value: v.amount_due}, )
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_due}, )
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_due}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_due}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Receivable"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-receivable-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function irRecFilterYear(year) {
        let urlAn = '/user/analytics?t=interest-receivable&&';
        let officer = $('#irrecchartfilterofficers').val(),
            freq = $("#ir-rec-frequency").val(),
            d=[], agent, xaxis;
        urlAn = urlAn.concat('freq='+freq+'&&officer='+officer+'&&year='+year.value);

        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_due}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_due}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_due}, );
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_due}, );
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_due}, );
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Quarters';
                        d.push({label: v.OfficerQuarter , value: v.amount_due}, );
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_due}, );
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_due}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_due}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Receivable"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#interest-receivable-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    // Principal Received

    function principalreceived(){
        let d = [];
        let start = $("#startDate").val(),
            end = $("#endDate").val(),
            url;
        url = (start === "" || start === null || end === "" || end === null ) ? 'user/disbursements/filter' : 'user/disbursements/filter?start='+formatDate(start)+'&&end='+formatDate(end)

        $.ajax({
            'url': 'user/analytics?t=principal-received',
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    d.push({label: v.officer , value: v.amount_received}, );
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Principal Received",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Loan Officers",
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#principal-received-chart").insertFusionCharts(chartConfigs);
//                loadInterestReceived();
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });

    }

    function prFilterOfficer(officer){
        let url = '/user/analytics?t=principal-received&&',
            freq = $('#pr-frequency').val(),
            year = $('#p-r-year').val();
        if (officer.value == 0 && freq == "-1"){
            return principalreceived();
        }
        url = url.concat('officer='+officer.value+'&&year='+year);
        if (freq != "2" || freq != '4'){
            $('#pr-year').hide();
            $('#p-r-year').val(0);
            url = url.concat('&&freq='+freq);
        }
        else{
            url = url.concat('&&freq='+freq);
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_received}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_received}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_received}, )
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_received}, )
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_received}, )
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Period';
                        d.push({label: v.OfficerQuarter , value: v.amount_received}, )
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_received}, )
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_received}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_received}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Principal Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#principal-received-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function prFrequencyChange(frequency){
        let url ='user/analytics?t=principal-received&&',
            year = $('#p-r-year').val(),
            officer = $('#prchartfilterofficers').val();
        if (frequency.value == 2 || frequency.value == 4){
            $('#pr-year').show();
            if (officer && year){
                url = url.concat('officer='+officer+'&&year='+year+'&&freq='+frequency.value);
            }
        }
        else {
            $('#pr-year').hide();
            $('#p-r-year').val(0);
            url = url.concat('officer='+officer+'&&freq='+frequency.value+'&&year='+$('#p-r-year').val());
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_received}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_received}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_received}, )
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_received}, )
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_received}, )
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Quarters';
                        d.push({label: v.OfficerQuarter , value: v.amount_received}, )
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_received}, )
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_received}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_received}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Interest Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#principal-received-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function prFilterYear(year) {
        let urlAn = '/user/analytics?t=principal-received&&';
        let officer = $('#prchartfilterofficers').val(),
            freq = $("#pr-frequency").val(),
            d=[], agent, xaxis;
        urlAn = urlAn.concat('freq='+freq+'&&officer='+officer+'&&year='+year.value);

        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_received}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_received}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_received}, );
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_received}, );
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_received}, );
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Quarters';
                        d.push({label: v.OfficerQuarter , value: v.amount_received}, );
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_received}, );
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_received}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_received}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Principal Received"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#principal-received-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    // Principal Receivable

    function principalreceivable(){
        let d = [];

        $.ajax({
            'url': 'user/analytics?t=principal-receivable',
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    d.push({label: v.officer , value: v.amount_due}, );
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Principal Receivable",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Loan Officers",
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#principal-receivable-chart").insertFusionCharts(chartConfigs);
//                loadInterestReceivable();
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });

    }

    function prRecFilterOfficer(officer){
        let url = '/user/analytics?t=principal-receivable&&',
            freq = $('#pr-rec-frequency').val(),
            year = $('#p-r-rec-year').val();
        if (officer.value == 0 && freq == "-1"){
            return principalreceivable();
        }
        if (freq != "2" || freq != '4'){
            $('#pr-rec-year').hide();
            $('#p-r-rec-year').val(0);
            url = url.concat('freq='+freq+'&&');
        }
        else{
            $('#pr-rec-year').show();
            url = url.concat('freq='+freq+'&&');
        }
        let d = [], agent = '', xaxis;
        url = url.concat('officer='+officer.value+'&&year='+year);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_due}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_due}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_due}, )
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_due}, )
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_due}, )
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Period';
                        d.push({label: v.OfficerQuarter , value: v.amount_due}, )
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_due}, )
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_due}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_due}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Principal Receivable"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#principal-receivable-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function prRecFrequencyChange(frequency){
        let url ='user/analytics?t=principal-receivable&&',
            year = $('#p-r-rec-year').val(),
            officer = $('#prrecchartfilterofficers').val();
        if (frequency.value == 2 || frequency.value == 4){
            $('#pr-rec-year').show();
            if (officer && year){
                url = url.concat('officer='+officer+'&&year='+year+'&&freq='+frequency.value+'&&');
            }
        }
        else {
            $('#pr-rec-year').hide();
            $('#p-r-rec-year').val(0);
            url = url.concat('officer='+officer+'&&freq='+frequency.value+'&&year='+$('#p-r-rec-year').val()+'&&');
        }
        let d = [], agent = '', xaxis;

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_due}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_due}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_due}, )
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_due}, )
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_due}, )
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Quarters';
                        d.push({label: v.OfficerQuarter , value: v.amount_due}, )
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_due}, )
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_due}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_due}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Principal Receivable"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#principal-receivable-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function prRecFilterYear(year) {
        let urlAn = '/user/analytics?t=principal-receivable&&';
        let officer = $('#prrecchartfilterofficers').val(),
            freq = $("#pr-rec-frequency").val(),
            d=[], agent, xaxis;
        urlAn = urlAn.concat('freq='+freq+'&&officer='+officer+'&&year='+year.value+'&&');

        $.ajax({
            'url': urlAn,
            'type': 'get',
            'success': function (data) {
//                (data.status === 200) ? populateDisbursed(data.response) : swal({"icon": "error", "text": 'Database Error'})
                jQuery.each(data.response, function(k, v){
                    if (v.officer){
                        agent = ': '+v.officer;
                        d.push({label: v.officer , value: v.amount_due}, );
                    }
                    if (v.year){
                        agent = ': '+v.agent;
                        xaxis = 'Years'
                        d.push({label: v.year , value: v.amount_due}, );
                    }
                    if (v.month){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.PaymentMonth , value: v.amount_due}, );
                    }
                    if (v.paymonth){
                        agent = ': '+v.agent;
                        xaxis = 'Months';
                        d.push({label: v.paymonth , value: v.amount_due}, );
                    }
                    if (v.Monthyear){
                        agent = ' ';
                        xaxis = 'Months';
                        d.push({label: v.Monthyear , value: v.amount_due}, );
                    }
                    if (v.OfficerQuarter){
                        agent = ': '+v.agent;
                        xaxis = 'Quarters';
                        d.push({label: v.OfficerQuarter , value: v.amount_due}, );
                    }
                    if (v.Quarter){
                        agent = '';
                        xaxis = 'Quarters';
                        d.push({label: v.Quarter , value: v.amount_due}, );
                    }
                    if (v.PaymentYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.PaymentYear, value: v.amount_due}, );
                    }
                    if (v.OfficerYear){
                        agent = '';
                        xaxis = 'Years';
                        d.push({label: v.OfficerYear, value: v.amount_due}, );
                    }
                });
                var chartConfigs = {
                    type: 'column2d', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        // Chart Configuration
                        "chart": {
                            "caption": "Principal Receivable"+agent,
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": xaxis,
                            "yAxisName": "Amount (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        // Chart Data
                        "data": d
                    }
                };
                $("#principal-receivable-chart").insertFusionCharts(chartConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    /// Principal Vs Interest Charts

    function loadPVIReceived(){
        let d = [], series = '', agent = '', xaxis, yaxis, caption, categories = [], dataset = [], datar = [], chartTemp, values = [], diffSeries = [], countSeries, seriesNames = [], nondupSeriesNames = [];
        $.ajax({
            'url': `user/multi-analytics?pvi=${pvi_report}`,
            'type': 'get',
            'success': function (data) {
                // All Branches
                if (pvi_report === 'received') {

                    jQuery.each(data.response, function (k, v) {
                        yaxis = "Amount Received (Naira)";
                        caption = 'Principal Received Vs Interest Received - All Loan Officers';
                        xaxis = 'Period';
                        categories.push({label: k});
                        chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                        values.push(chartTemp);
                        diffSeries.push(chartTemp.length);
                        jQuery.each(v, function (key, val) {
                            seriesNames.push(val.branch);
                        });
                    });
                    countSeries = Math.max.apply(Math, diffSeries);
                    nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                        return index === self.indexOf(elem);
                    }).sort();
                    let datum = [], datas = [];
                    for (let i = 0; i < values.length; i++) {
                        if (values[i][0]){
                            datum.push({value: values[i][0].interest_received});
                        } else {
                            datum.push({value: 0});
                        }
                    }
                    for (let i = 0; i < values.length; i++) {
                        if (values[i][0]){
                            datas.push({value: values[i][0].principal_received});
                        } else {
                            datas.push({value: 0});
                        }
                    }
                    dataset.push({seriesname: 'Interest Received', data: datum});
                    dataset.push({seriesname: 'Principal Received', data: datas});
                }
                if (pvi_report === 'receivable') {
                    jQuery.each(data.response, function (k, v) {
                        yaxis = 'Interest Earned (Naira)';
                        caption = 'Interest Earned by Branches';
                        xaxis = 'Period';
                        categories.push({label: k});
                        chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                        values.push(chartTemp);
                        diffSeries.push(chartTemp.length);
                        jQuery.each(v, function (key, val) {
                            seriesNames.push(val.office);
                        });
                    });
                    countSeries = Math.max.apply(Math, diffSeries);
                    nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                        return index === self.indexOf(elem);
                    }).sort();
                    for (let j = 0; j < nondupSeriesNames.length; j++) {
                        let datum = [];
                        for (let i = 0; i < values.length; i++) {
                            let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];
                            if (branch_series_value){
                                datum.push({value: branch_series_value.amount_received});
                            } else {
                                datum.push({value: 0});
                            }
                        }
                        dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                    }
                }
                var dConfigs = {
                    type: 'mscolumn2d',
                    renderAt: 'chart-container',
                    width: '100%',
                    height: '400',
                    dataFormat: 'json',
                    dataSource: {
                        "chart": {
                            "theme": "fusion",
                            "caption": caption,
                            "xAxisname": 'Period',
                            "yAxisName": "Amount (In Naira)",
                            "plotFillAlpha": "80",
                            "divLineIsDashed": "1",
                            "divLineDashLen": "1",
                            "divLineGapLen": "1"
                        },
                        "categories": [{'category': categories}],
                        "dataset": dataset
                    }
                };
                $("#vrs-chart").insertFusionCharts(dConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function loadPVIReceivable(){

    }

    function pviFilterOfficer(office){
        let url;
        let year = $('#pvi-year').val();
        let officer = office.value,
            freq = $('#pvi-frequency').val();
        url = `user/multi-analytics?pvi=${pvi_report}&&officer=${officer}&&`;

        if (pvi_report === -1){
            return loadPVIReceived();
        }
        if (freq == 2 || freq == 4){
            $('#pvi-yr').show();
            if (officer && year){
                url = url.concat(`year=${year}&&freq=${freq}`);
            }
        }
        else {
            $('#pvi-yr').hide();
            $('#pvi-year').val(0);
            url = url.concat(`freq=${freq}&&year=0`);
        }
        let d = [], series = '', agent = '', xaxis, yaxis, l_off, caption, categories = [], dataset = [], datar = [], chartTemp, values = [], diffSeries = [], countSeries, seriesNames = [], nondupSeriesNames = [];
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                // All Branches
                if (pvi_report === 'received') {

                    jQuery.each(data.response, function (k, v) {
                        yaxis = "Amount Received (Naira)";
                        caption = 'Principal Received Vs Interest Received';
                        xaxis = 'Period';
                        categories.push({label: k});
                        chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                        values.push(chartTemp);
                        diffSeries.push(chartTemp.length);
                        jQuery.each(v, function (key, val) {
                            seriesNames.push(val.branch);
                        });
                    });
                    countSeries = Math.max.apply(Math, diffSeries);
                    nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                        return index === self.indexOf(elem);
                    }).sort();
                    let datum = [], datas = [];
                    for (let i = 0; i < values.length; i++) {
                        if (values[i][0]){
                            l_off = values[i][0].officer;
                            datum.push({value: values[i][0].interest_received});
                        } else {
                            l_off = '??';
                            datum.push({value: 0});
                        }
                    }
                    for (let i = 0; i < values.length; i++) {
                        if (values[i][0]){
                            datas.push({value: values[i][0].principal_received});
                        } else {
                            datas.push({value: 0});
                        }
                    }
                    dataset.push({seriesname: 'Interest Received', data: datum});
                    dataset.push({seriesname: 'Principal Received', data: datas});
                }
                if (pvi_report === 'receivable') {
                    jQuery.each(data.response, function (k, v) {
                        yaxis = 'Interest Earned (Naira)';
                        caption = 'Interest Earned by Branches';
                        xaxis = 'Period';
                        categories.push({label: k});
                        chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                        values.push(chartTemp);
                        diffSeries.push(chartTemp.length);
                        jQuery.each(v, function (key, val) {
                            seriesNames.push(val.office);
                        });
                    });
                    countSeries = Math.max.apply(Math, diffSeries);
                    nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                        return index === self.indexOf(elem);
                    }).sort();
                    for (let j = 0; j < nondupSeriesNames.length; j++) {
                        let datum = [];
                        for (let i = 0; i < values.length; i++) {
                            let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];
                            if (branch_series_value){
                                datum.push({value: branch_series_value.amount_received});
                            } else {
                                datum.push({value: 0});
                            }
                        }
                        dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                    }
                }
                var dConfigs = {
                    type: 'mscolumn2d',
                    renderAt: 'chart-container',
                    width: '100%',
                    height: '400',
                    dataFormat: 'json',
                    dataSource: {
                        "chart": {
                            "theme": "fusion",
                            "caption": caption+ ' - '+l_off,
                            "xAxisname": 'Period',
                            "yAxisName": "Amount (In Naira)",
                            "plotFillAlpha": "80",
                            "divLineIsDashed": "1",
                            "divLineDashLen": "1",
                            "divLineGapLen": "1"
                        },
                        "categories": [{'category': categories}],
                        "dataset": dataset
                    }
                };
                $("#vrs-chart").insertFusionCharts(dConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function pviFrequencyChange(frequency){
        let url;
        let year = $('#pvi-year').val();
        let officer = $('#pvifilterofficers').val();
        url = `user/multi-analytics?pvi=${pvi_report}&&officer=${officer}&&`;

        if (pvi_report === -1){
//            return swal('Please choose a report to compare!', '','warning');
            return loadPVIReceived();
        }
        if (frequency.value == 2 || frequency.value == 4){
            $('#pvi-yr').show();
            if (officer && year){
                url = url.concat(`year=${year}&&freq=${frequency.value}`);
            }
        }
        else {
            $('#pvi-yr').hide();
            $('#pvi-year').val(0);
            url = url.concat(`freq=${frequency.value}&&year=0`);
        }
        let d = [], series = '', agent = '', xaxis, yaxis, l_off, caption, categories = [], dataset = [], datar = [], chartTemp, values = [], diffSeries = [], countSeries, seriesNames = [], nondupSeriesNames = [];
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                // All Branches
                if (pvi_report === 'received') {

                    jQuery.each(data.response, function (k, v) {
                        yaxis = "Amount Received (Naira)";
                        caption = 'Principal Received Vs Interest Received';
                        xaxis = 'Period';
                        categories.push({label: k});
                        chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                        values.push(chartTemp);
                        diffSeries.push(chartTemp.length);
                        jQuery.each(v, function (key, val) {
                            seriesNames.push(val.branch);
                        });
                    });
                    countSeries = Math.max.apply(Math, diffSeries);
                    nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                        return index === self.indexOf(elem);
                    }).sort();
                    let datum = [], datas = [];
                    for (let i = 0; i < values.length; i++) {
                        if (values[i][0]){
                            l_off = values[i][0].officer;
                            datum.push({value: values[i][0].interest_received});
                        } else {
                            l_off = $("#pvifilterofficers option:selected").text();
                            datum.push({value: 0});
                        }
                    }
                    for (let i = 0; i < values.length; i++) {
                        if (values[i][0]){
                            datas.push({value: values[i][0].principal_received});
                        } else {
                            datas.push({value: 0});
                        }
                    }
                    dataset.push({seriesname: 'Interest Received', data: datum});
                    dataset.push({seriesname: 'Principal Received', data: datas});
                }
                if (officer == '0')
                    l_off = 'All Loan Officers';
                if (pvi_report === 'receivable') {
                    jQuery.each(data.response, function (k, v) {
                        yaxis = 'Interest Earned (Naira)';
                        caption = 'Interest Earned by Branches';
                        xaxis = 'Period';
                        categories.push({label: k});
                        chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                        values.push(chartTemp);
                        diffSeries.push(chartTemp.length);
                        jQuery.each(v, function (key, val) {
                            seriesNames.push(val.office);
                        });
                    });
                    countSeries = Math.max.apply(Math, diffSeries);
                    nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                        return index === self.indexOf(elem);
                    }).sort();
                    for (let j = 0; j < nondupSeriesNames.length; j++) {
                        let datum = [];
                        for (let i = 0; i < values.length; i++) {
                            let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];
                            if (branch_series_value){
                                datum.push({value: branch_series_value.amount_received});
                            } else {
                                datum.push({value: 0});
                            }
                        }
                        dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                    }
                }
                var dConfigs = {
                    type: 'mscolumn2d',
                    renderAt: 'chart-container',
                    width: '100%',
                    height: '400',
                    dataFormat: 'json',
                    dataSource: {
                        "chart": {
                            "theme": "fusion",
                            "caption": caption+ ' - '+l_off,
                            "xAxisname": 'Period',
                            "yAxisName": "Amount (In Naira)",
                            "plotFillAlpha": "80",
                            "divLineIsDashed": "1",
                            "divLineDashLen": "1",
                            "divLineGapLen": "1"
                        },
                        "categories": [{'category': categories}],
                        "dataset": dataset
                    }
                };
                $("#vrs-chart").insertFusionCharts(dConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function pviFilterYear(year) {
        let officer = $('#pvifilterofficers').val(),
            freq = $('#pvi-frequency').val(),
            url = `user/multi-analytics?pvi=${pvi_report}&&officer=${officer}&&`,
            d=[], agent, xaxis, yaxis, l_off, caption, categories = [], dataset = [], datar = [], chartTemp, values = [], diffSeries = [], countSeries, seriesNames = [], nondupSeriesNames = [];
        if (pvi_report === -1){
//            return swal('Please choose a report to compare!', '','warning');
            return loadPVIReceived();
        }
        url = url.concat(`freq=${freq}&&year=${year.value}`);

        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                if (pvi_report === 'received') {
                    jQuery.each(data.response, function (k, v) {
                        yaxis = "Amount Received (Naira)";
                        caption = 'Principal Received Vs Interest Received';
                        xaxis = 'Period';
                        categories.push({label: k});
                        chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                        values.push(chartTemp);
                        diffSeries.push(chartTemp.length);
                        jQuery.each(v, function (key, val) {
                            seriesNames.push(val.branch);
                        });
                    });
                    countSeries = Math.max.apply(Math, diffSeries);
                    nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                        return index === self.indexOf(elem);
                    }).sort();
                    let datum = [], datas = [];
                    for (let i = 0; i < values.length; i++) {
                        if (values[i][0]){
                            l_off = values[i][0].officer;
                            datum.push({value: values[i][0].interest_received});
                        } else {
                            l_off = $("#pvifilterofficers option:selected").text();
                            datum.push({value: 0});
                        }
                    }
                    for (let i = 0; i < values.length; i++) {
                        if (values[i][0]){
                            datas.push({value: values[i][0].principal_received});
                        } else {
                            datas.push({value: 0});
                        }
                    }
                    dataset.push({seriesname: 'Interest Received', data: datum});
                    dataset.push({seriesname: 'Principal Received', data: datas});
                }
                if (officer == '0')
                    l_off = 'All Loan Officers';
                if (pvi_report === 'receivable') {
                    jQuery.each(data.response, function (k, v) {
                        yaxis = 'Interest Earned (Naira)';
                        caption = 'Interest Earned by Branches';
                        xaxis = 'Period';
                        categories.push({label: k});
                        chartTemp = $.grep(v, function(e){return e.period === k.toString();});
                        values.push(chartTemp);
                        diffSeries.push(chartTemp.length);
                        jQuery.each(v, function (key, val) {
                            seriesNames.push(val.office);
                        });
                    });
                    countSeries = Math.max.apply(Math, diffSeries);
                    nondupSeriesNames = seriesNames.filter(function(elem, index, self) {
                        return index === self.indexOf(elem);
                    }).sort();
                    for (let j = 0; j < nondupSeriesNames.length; j++) {
                        let datum = [];
                        for (let i = 0; i < values.length; i++) {
                            let branch_series_value = ($.grep(values[i], function(e){return e.office === nondupSeriesNames[j];}))[0];
                            if (branch_series_value){
                                datum.push({value: branch_series_value.amount_received});
                            } else {
                                datum.push({value: 0});
                            }
                        }
                        dataset.push({seriesname: nondupSeriesNames[j], data: datum});
                    }
                }
                var dConfigs = {
                    type: 'mscolumn2d',
                    renderAt: 'chart-container',
                    width: '100%',
                    height: '400',
                    dataFormat: 'json',
                    dataSource: {
                        "chart": {
                            "theme": "fusion",
                            "caption": caption+ ' - '+l_off,
                            "xAxisname": 'Period',
                            "yAxisName": "Amount (In Naira)",
                            "plotFillAlpha": "80",
                            "divLineIsDashed": "1",
                            "divLineDashLen": "1",
                            "divLineGapLen": "1"
                        },
                        "categories": [{'category': categories}],
                        "dataset": dataset
                    }
                };
                $("#vrs-chart").insertFusionCharts(dConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    // Growth Trends

    let dr, ir, irec;
    function trends(){
        let d = [], interest = [], interest_rec = [];
        $.ajax({
            'url': 'user/growth-trends',
            'type': 'get',
            'success': function (data) {
                dr = data.message.disbursements;
                ir = data.message.interest_received;
                irec = data.message.interest_receivable;
                jQuery.each(dr, function(k, v){
                    d.push({label: v.period , value: v.amount}, );
                });
                jQuery.each(ir, function(k, v){
                    interest.push({label: v.period , value: v.amount}, );
                });
                jQuery.each(irec, function(k, v){
                    interest_rec.push({label: v.period , value: v.amount}, );
                });
                var disburseConfigs = {
                    type: 'line', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        "chart": {
                            "caption": "Monthly Disbursements",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Period",
                            "yAxisName": "Amount Disbursed (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        "data": d
                    }
                };
                var interestConfigs = {
                    type: 'line', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        "chart": {
                            "caption": "Monthly Interest Received",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Period",
                            "yAxisName": "Interest Received (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        "data": interest
                    }
                };
                var intRecConfigs = {
                    type: 'line', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        "chart": {
                            "caption": "Monthly Interest Receivable",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Period",
                            "yAxisName": "Interest Receivable (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        "data": interest_rec
                    }
                };
                $("#disburse-trend-chart").insertFusionCharts(disburseConfigs);
                $("#interest-received-trend-chart").insertFusionCharts(interestConfigs);
                $("#interest-receivable-trend-chart").insertFusionCharts(intRecConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function agr(values){
        let new_values = values.filter(value => value.period !== null).filter(value => value.amount !== 0);
        let amounts = new_values.map(value => value.amount);
        let ind_avgs = [];
        for (let i = 0; i < amounts.length; i++){
            if (i !== amounts.length - 1)
                ind_avgs.push(parseFloat((amounts[i+1]/amounts[i]) - 1)*100)
        }
        let sum_avg = ind_avgs.reduce((acc, avrg) => acc + avrg, 0);
        let avg_rate = sum_avg/ind_avgs.length;
//        let start = new_values[0].amount;
//        let end = new_values[new_values.length - 1].amount;
//        let avg = parseFloat(Math.pow((end/start), 1/new_values.length) - 1);
//        let avg_rate = avg * 100;
        $('#growth-rate').html(avg_rate.toFixed(2)+'%');
    }

    function changeTrend(type){
        $('#agr').hide();

        $('#trend-year').val(0);
        $('#trend-frequency').val(-1);
        if (type.value === 'Disbursements'){
            agr(dr);
            $('#agr').show();
            $('#disburse-trend-chart').show();
            $('#interest-received-trend-chart').hide();
            $('#interest-receivable-trend-chart').hide();
        }
        else if (type.value == 'Interest Received'){
            agr(ir);
            $('#agr').show();
            $('#interest-received-trend-chart').show();
            $('#disburse-trend-chart').hide();
            $('#interest-receivable-trend-chart').hide();
        }
        else if (type.value == 'Interest Receivable'){
            agr(irec);
            $('#agr').show();
            $('#interest-receivable-trend-chart').show();
            $('#disburse-trend-chart').hide();
            $('#interest-received-trend-chart').hide();
        }
        else {
            $('#agr').hide();
            $('#interest-receivable-trend-chart').hide();
            $('#disburse-trend-chart').hide();
            $('#interest-received-trend-chart').hide();
        }
    }

    function trendFrequencyChange(frequency){
        let url = 'user/growth-trends';
        let report = $('#trend-report').val();
        let freq = frequency.value;
        let year = $('#trend-year').val();
        if (freq === '3')
            $('#trend-year').hide();
        else
            $('#trend-year').show();
        if (report === 'Disbursements'){
            let d = [];
            url = `user/disbursement-trends?year=${year}&&frequency=${freq}`
            $.ajax({
                'url': url,
                'type': 'get',
                'success': function (data) {
                    dr = data.message.disbursements;
                    jQuery.each(dr, function(k, v){
                        d.push({label: v.period , value: v.amount}, );
                    });
                    var disburseConfigs = {
                        type: 'line', // The chart type
                        width: '100%', // Width of the chart
                        height: '400', // Height of the chart
                        dataFormat: 'json', // Data type
                        dataSource: {
                            "chart": {
                                "caption": "Monthly Disbursements",
//                            "subCaption": "In MMbbl = One Million barrels",
                                "xAxisName": "Period",
                                "yAxisName": "Amount Disbursed (In Naira)",
                                "numberSuffix": "",
                                "theme": "fusion",
                            },
                            "data": d
                        }
                    };
                    $("#disburse-trend-chart").insertFusionCharts(disburseConfigs);
                    agr(dr);
                },
                'error': function (err) {
                    return swal('Error in Connection!','','error')
                }
            });
        }
        if (report === 'Interest Received'){
            let interest = [];
            url = `user/interest-received-trends?year=${year}&&frequency=${freq}`
            $.ajax({
                'url': url,
                'type': 'get',
                'success': function (data) {
                    ir = data.message.interest_received;
                    jQuery.each(ir, function(k, v){
                        interest.push({label: v.period , value: v.amount}, );
                    });
                    var interestConfigs = {
                        type: 'line', // The chart type
                        width: '100%', // Width of the chart
                        height: '400', // Height of the chart
                        dataFormat: 'json', // Data type
                        dataSource: {
                            "chart": {
                                "caption": "Monthly Interest Received",
//                            "subCaption": "In MMbbl = One Million barrels",
                                "xAxisName": "Period",
                                "yAxisName": "Interest Received (In Naira)",
                                "numberSuffix": "",
                                "theme": "fusion",
                            },
                            "data": interest
                        }
                    };
                    $("#interest-received-trend-chart").insertFusionCharts(interestConfigs);
                    agr(ir);
                },
                'error': function (err) {
                    return swal('Error in Connection!','','error')
                }
            });
        }
        if (report === 'Interest Receivable'){
            let interest_rec = [];
            url = `user/interest-receivable-trends?year=${year}&&frequency=${freq}`
            $.ajax({
                'url': url,
                'type': 'get',
                'success': function (data) {
                    irec = data.message.interest_receivable;
                    jQuery.each(irec, function(k, v){
                        interest_rec.push({label: v.period , value: v.amount}, );
                    });
                    var intRecConfigs = {
                        type: 'line', // The chart type
                        width: '100%', // Width of the chart
                        height: '400', // Height of the chart
                        dataFormat: 'json', // Data type
                        dataSource: {
                            "chart": {
                                "caption": "Monthly Interest Receivable",
//                            "subCaption": "In MMbbl = One Million barrels",
                                "xAxisName": "Period",
                                "yAxisName": "Interest Receivable (In Naira)",
                                "numberSuffix": "",
                                "theme": "fusion",
                            },
                            "data": interest_rec
                        }
                    };
                    $("#interest-receivable-trend-chart").insertFusionCharts(intRecConfigs);
                    agr(irec);
                },
                'error': function (err) {
                    return swal('Error in Connection!','','error')
                }
            });
        }
    }

    function trendYearChange(yr){
        let url = 'user/growth-trends';
        let report = $('#trend-report').val();
        let freq = $('#trend-frequency').val();
        let year = yr.value;
        if (freq === '3')
            $('#trend-year').hide();
        else
            $('#trend-year').show();
        if (report === 'Disbursements'){
            let d = [];
            url = `user/disbursement-trends?year=${year}&&frequency=${freq}`
            $.ajax({
                'url': url,
                'type': 'get',
                'success': function (data) {
                    dr = data.message.disbursements;
                    jQuery.each(dr, function(k, v){
                        d.push({label: v.period , value: v.amount}, );
                    });
                    var disburseConfigs = {
                        type: 'line', // The chart type
                        width: '100%', // Width of the chart
                        height: '400', // Height of the chart
                        dataFormat: 'json', // Data type
                        dataSource: {
                            "chart": {
                                "caption": "Monthly Disbursements",
//                            "subCaption": "In MMbbl = One Million barrels",
                                "xAxisName": "Period",
                                "yAxisName": "Amount Disbursed (In Naira)",
                                "numberSuffix": "",
                                "theme": "fusion",
                            },
                            "data": d
                        }
                    };
                    $("#disburse-trend-chart").insertFusionCharts(disburseConfigs);
                    agr(dr);
                },
                'error': function (err) {
                    return swal('Error in Connection!','','error')
                }
            });
        }
        if (report === 'Interest Received'){
            let interest = [];
            url = `user/interest-received-trends?year=${year}&&frequency=${freq}`
            $.ajax({
                'url': url,
                'type': 'get',
                'success': function (data) {
                    ir = data.message.interest_received;
                    jQuery.each(ir, function(k, v){
                        interest.push({label: v.period , value: v.amount}, );
                    });
                    var interestConfigs = {
                        type: 'line', // The chart type
                        width: '100%', // Width of the chart
                        height: '400', // Height of the chart
                        dataFormat: 'json', // Data type
                        dataSource: {
                            "chart": {
                                "caption": "Monthly Interest Received",
//                            "subCaption": "In MMbbl = One Million barrels",
                                "xAxisName": "Period",
                                "yAxisName": "Interest Received (In Naira)",
                                "numberSuffix": "",
                                "theme": "fusion",
                            },
                            "data": interest
                        }
                    };
                    $("#interest-received-trend-chart").insertFusionCharts(interestConfigs);
                    agr(ir);
                },
                'error': function (err) {
                    return swal('Error in Connection!','','error')
                }
            });
        }
        if (report === 'Interest Receivable'){
            let interest_rec = [];
            url = `user/interest-receivable-trends?year=${year}&&frequency=${freq}`
            $.ajax({
                'url': url,
                'type': 'get',
                'success': function (data) {
                    irec = data.message.interest_receivable;
                    jQuery.each(irec, function(k, v){
                        interest_rec.push({label: v.period , value: v.amount}, );
                    });
                    var intRecConfigs = {
                        type: 'line', // The chart type
                        width: '100%', // Width of the chart
                        height: '400', // Height of the chart
                        dataFormat: 'json', // Data type
                        dataSource: {
                            "chart": {
                                "caption": "Monthly Interest Receivable",
//                            "subCaption": "In MMbbl = One Million barrels",
                                "xAxisName": "Period",
                                "yAxisName": "Interest Receivable (In Naira)",
                                "numberSuffix": "",
                                "theme": "fusion",
                            },
                            "data": interest_rec
                        }
                    };
                    $("#interest-receivable-trend-chart").insertFusionCharts(intRecConfigs);
                    agr(irec);
                },
                'error': function (err) {
                    return swal('Error in Connection!','','error')
                }
            });
        }
    }

    // Demographics Reports

    function demographics(){
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                int = data.message.interest;
                bl = data.message.bad_loans;
                ol = data.message.overdue_loans;
                jQuery.each(dr, function(k, v){
                    d.push({label: v.period , value: v.amount}, );
                });
                jQuery.each(ir, function(k, v){
                    interest.push({label: v.period , value: v.amount}, );
                });
                jQuery.each(irec, function(k, v){
                    interest_rec.push({label: v.period , value: v.amount}, );
                });
                var disburseConfigs = {
                    type: 'line', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        "chart": {
                            "caption": "Monthly Disbursements",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Period",
                            "yAxisName": "Amount Disbursed (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        "data": d
                    }
                };
                var interestConfigs = {
                    type: 'line', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        "chart": {
                            "caption": "Monthly Interest Received",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Period",
                            "yAxisName": "Interest Received (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        "data": interest
                    }
                };
                var intRecConfigs = {
                    type: 'line', // The chart type
                    width: '100%', // Width of the chart
                    height: '400', // Height of the chart
                    dataFormat: 'json', // Data type
                    dataSource: {
                        "chart": {
                            "caption": "Monthly Interest Receivable",
//                            "subCaption": "In MMbbl = One Million barrels",
                            "xAxisName": "Period",
                            "yAxisName": "Interest Receivable (In Naira)",
                            "numberSuffix": "",
                            "theme": "fusion",
                        },
                        "data": interest_rec
                    }
                };
                $("#disburse-trend-chart").insertFusionCharts(disburseConfigs);
                $("#interest-received-trend-chart").insertFusionCharts(interestConfigs);
                $("#interest-receivable-trend-chart").insertFusionCharts(intRecConfigs);
            },
            'error': function (err) {
                swal('Error in Connection!','','error')
            }
        });
    }

    function demoReportChange(report){
        $('#demo-year').val(0);
        $('#demo-frequency').val(-1);
        if (report.value === 'Interest'){
            $('#interest-demo-chart').show();
            $('#badloan-demo-chart').hide();
            $('#overdue-demo-chart').hide();
        }
        else if (report.value === 'Bad Loans'){
            $('#interest-demo-chart').hide();
            $('#badloan-demo-chart').show();
            $('#overdue-demo-chart').hide();
        }
        else if (report.value === 'Overdue Loans'){
            $('#interest-demo-chart').hide();
            $('#badloan-demo-chart').hide();
            $('#overdue-demo-chart').show();
        }
    }

    function demoFilterChange(filter){
        let url, caption, xaxisname,
            period = $('#demo-frequency').val(),
            year = $('#demo-year').val(),
            report = $('#demo-report option:selected').attr('id');
//        url = `/user/trends?trend=${report}&&filter=${filter.value}&&`;
        if (report === "-1"){
            return swal('', 'Please Choose a Report!', 'warning');
        }
        if (report === 'Interest'){
            let d = [];
            url = `/user/demographic-interest-report?trend=${report}&&filter=${filter.value}&&period=${period}&&year=${year}`,
                $.ajax({
                    'url': url,
                    'type': 'get',
                    'success': function (data) {
                        int = data.message.interest;
                        jQuery.each(int, function(k, v){
                            if (v.gender){
                                d.push({label: v.gender , value: v.amount}, );
                                caption = 'Interest Received by Gender';
                                xaxisname = 'Gender';
                            }
                            if (v.dob){
                                d.push({label: v.age_range, value: v.amount}, );
                                caption = 'Interest Received by Age Groups';
                                xaxisname = 'Age Groups';
                            }
                        });
                        var interestConfigs = {
                            type: 'column2d', // The chart type
                            width: '100%', // Width of the chart
                            height: '400', // Height of the chart
                            dataFormat: 'json', // Data type
                            dataSource: {
                                "chart": {
                                    "caption": caption,
//                            "subCaption": "In MMbbl = One Million barrels",
                                    "xAxisName": xaxisname,
                                    "yAxisName": "Amount (In Naira)",
                                    "numberSuffix": "",
                                    "theme": "fusion",
                                },
                                "data": d
                            }
                        };
                        $('#interest-demo-chart').show();
                        $("#interest-demo-chart").insertFusionCharts(interestConfigs);
                    },
                    'error': function (err) {
                        return swal('Error in Connection!','','error')
                    }
                });
        }
        if (report === 'Bad Loans'){
            let d = [];
            url = `user/demographic-badloans-report?trend=${report}&&filter=${filter.value}&&period=${period}&&year=${year}`,
                $.ajax({
                    'url': url,
                    'type': 'get',
                    'success': function (data) {
                        bd = data.message.badloans;
                        jQuery.each(bd, function(k, v){
                            if (v.gender){
                                d.push({label: v.gender , value: v.amount}, );
                                caption = 'Badloans by Gender';
                                xaxisname = 'Gender';
                            }
                            if (v.dob){
                                d.push({label: v.age_range, value: v.amount}, );
                                caption = 'Badloans by Age Groups';
                                xaxisname = 'Age Groups';
                            }
                        });
                        var badloanConfigs = {
                            type: 'column2d', // The chart type
                            width: '100%', // Width of the chart
                            height: '400', // Height of the chart
                            dataFormat: 'json', // Data type
                            dataSource: {
                                "chart": {
                                    "caption": caption,
//                            "subCaption": "In MMbbl = One Million barrels",
                                    "xAxisName": xaxisname,
                                    "yAxisName": "Amount (In Naira)",
                                    "numberSuffix": "",
                                    "theme": "fusion",
                                },
                                "data": d
                            }
                        };
                        $('#badloan-demo-chart').show();
                        $("#badloan-demo-chart").insertFusionCharts(badloanConfigs);
                    },
                    'error': function (err) {
                        return swal('Error in Connection!','','error')
                    }
                });
        }
        if (report === 'Overdue Loans'){
            let d = [];
            url = `user/demographic-overdues-report?trend=${report}&&filter=${filter.value}&&period=${period}&&year=${year}`,
                $.ajax({
                    'url': url,
                    'type': 'get',
                    'success': function (data) {
                        od = data.message.overdues;
                        jQuery.each(od, function(k, v){
                            if (v.gender){
                                d.push({label: v.gender , value: v.amount}, );
                                caption = 'Overdue Loans by Gender';
                                xaxisname = 'Gender';
                            }
                            if (v.dob){
                                d.push({label: v.age_range, value: v.amount}, );
                                caption = 'Overdue Loans by Age Groups';
                                xaxisname = 'Age Groups';
                            }
                        });
                        var overdueConfigs = {
                            type: 'column2d', // The chart type
                            width: '100%', // Width of the chart
                            height: '400', // Height of the chart
                            dataFormat: 'json', // Data type
                            dataSource: {
                                "chart": {
                                    "caption": caption,
//                            "subCaption": "In MMbbl = One Million barrels",
                                    "xAxisName": xaxisname,
                                    "yAxisName": "Amount (In Naira)",
                                    "numberSuffix": "",
                                    "theme": "fusion",
                                },
                                "data": d
                            }
                        };
                        $('#overdue-demo-chart').show();
                        $("#overdue-demo-chart").insertFusionCharts(overdueConfigs);
                    },
                    'error': function (err) {
                        return swal('Error in Connection!','','error')
                    }
                });
        }
    }

    function demoFrequencyChange(period){
        let report = $('#demo-report option:selected').attr('id'),
            filter = $('#demo-filter option:selected').attr('id'),
            year = $('#demo-year').val(),
            url, caption, xaxisname;
        if (report === "-1"){
            return swal('', 'Please Choose a Report!', 'warning');
        }
        if (filter === "-1"){
            return swal('', 'Please Select a Filter!', 'warning');
        }
        if (period.value === '-1'){
            $('#demo-year').val(0);
        }
        if (report === 'Interest'){
            let d = [];
            url = url,
                $.ajax({
                    'url': `/user/demographic-interest-report?trend=${report}&&filter=${filter}&&period=${period.value}&&year=${year}`,
                    'type': 'get',
                    'success': function (data) {
                        int = data.message.interest;
                        jQuery.each(int, function(k, v){
                            if (v.gender){
                                d.push({label: v.gender , value: v.amount}, );
                                caption = 'Interest Received by Gender';
                                xaxisname = 'Gender';
                            }
                            if (v.dob){
                                d.push({label: v.age_range, value: v.amount}, );
                                caption = 'Interest Received by Age Groups';
                                xaxisname = 'Age Groups';
                            }
                        });
                        var interestConfigs = {
                            type: 'column2d', // The chart type
                            width: '100%', // Width of the chart
                            height: '400', // Height of the chart
                            dataFormat: 'json', // Data type
                            dataSource: {
                                "chart": {
                                    "caption": caption,
//                            "subCaption": "In MMbbl = One Million barrels",
                                    "xAxisName": xaxisname,
                                    "yAxisName": "Amount (In Naira)",
                                    "numberSuffix": "",
                                    "theme": "fusion",
                                },
                                "data": d
                            }
                        };
                        $('#interest-demo-chart').show();
                        $("#interest-demo-chart").insertFusionCharts(interestConfigs);
                    },
                    'error': function (err) {
                        return swal('Error in Connection!','','error')
                    }
                });
        }
        if (report === 'Bad Loans'){
            let d = [];
            url = `user/demographic-badloans-report?trend=${report}&&filter=${filter}&&period=${period.value}&&year=${year}`,
                $.ajax({
                    'url': url,
                    'type': 'get',
                    'success': function (data) {
                        bd = data.message.badloans;
                        jQuery.each(bd, function(k, v){
                            if (v.gender){
                                d.push({label: v.gender , value: v.amount}, );
                                caption = 'Badloans by Gender';
                                xaxisname = 'Gender';
                            }
                            if (v.dob){
                                d.push({label: v.age_range, value: v.amount}, );
                                caption = 'Badloans by Age Groups';
                                xaxisname = 'Age Groups';
                            }
                        });
                        var badloanConfigs = {
                            type: 'column2d', // The chart type
                            width: '100%', // Width of the chart
                            height: '400', // Height of the chart
                            dataFormat: 'json', // Data type
                            dataSource: {
                                "chart": {
                                    "caption": caption,
//                            "subCaption": "In MMbbl = One Million barrels",
                                    "xAxisName": xaxisname,
                                    "yAxisName": "Amount (In Naira)",
                                    "numberSuffix": "",
                                    "theme": "fusion",
                                },
                                "data": d
                            }
                        };
                        $('#badloan-demo-chart').show();
                        $("#badloan-demo-chart").insertFusionCharts(badloanConfigs);
                    },
                    'error': function (err) {
                        return swal('Error in Connection!','','error')
                    }
                });
        }
        if (report === 'Overdue Loans'){
            let d = [];
            url = `user/demographic-overdues-report?trend=${report}&&filter=${filter}&&period=${period.value}&&year=${year}`,
                $.ajax({
                    'url': url,
                    'type': 'get',
                    'success': function (data) {
                        od = data.message.overdues;
                        jQuery.each(od, function(k, v){
                            if (v.gender){
                                d.push({label: v.gender , value: v.amount}, );
                                caption = 'Overdue Loans by Gender';
                                xaxisname = 'Gender';
                            }
                            if (v.dob){
                                d.push({label: v.age_range, value: v.amount}, );
                                caption = 'Overdue Loans by Age Groups';
                                xaxisname = 'Age Groups';
                            }
                        });
                        var overdueConfigs = {
                            type: 'column2d', // The chart type
                            width: '100%', // Width of the chart
                            height: '400', // Height of the chart
                            dataFormat: 'json', // Data type
                            dataSource: {
                                "chart": {
                                    "caption": caption,
//                            "subCaption": "In MMbbl = One Million barrels",
                                    "xAxisName": xaxisname,
                                    "yAxisName": "Amount (In Naira)",
                                    "numberSuffix": "",
                                    "theme": "fusion",
                                },
                                "data": d
                            }
                        };
                        $('#overdue-demo-chart').show();
                        $("#overdue-demo-chart").insertFusionCharts(overdueConfigs);
                    },
                    'error': function (err) {
                        return swal('Error in Connection!','','error')
                    }
                });
        }
    }

    function demoYearChange(year){
        let report = $('#demo-report option:selected').attr('id'),
            filter = $('#demo-filter option:selected').attr('id'),
            period = $('#demo-frequency').val(),
            url, caption, xaxisname;
        if (report === "-1"){
            return swal('', 'Please Choose a Report!', 'warning');
        }
        if (filter === "-1"){
            return swal('', 'Please Select a Filter!', 'warning');
        }
        if (period === "-1"){
            return swal('', 'Please Select a Period!', 'warning');
        }
        if (report === 'Interest'){
            let d = [];
            url = url,
                $.ajax({
                    'url': `/user/demographic-interest-report?trend=${report}&&filter=${filter}&&period=${period}&&year=${year.value}`,
                    'type': 'get',
                    'success': function (data) {
                        int = data.message.interest;
                        jQuery.each(int, function(k, v){
                            if (v.gender){
                                d.push({label: v.gender , value: v.amount}, );
                                caption = 'Interest Received by Gender';
                                xaxisname = 'Gender';
                            }
                            if (v.dob){
                                d.push({label: v.age_range, value: v.amount}, );
                                caption = 'Interest Received by Age Groups';
                                xaxisname = 'Age Groups';
                            }
                        });
                        var interestConfigs = {
                            type: 'column2d', // The chart type
                            width: '100%', // Width of the chart
                            height: '400', // Height of the chart
                            dataFormat: 'json', // Data type
                            dataSource: {
                                "chart": {
                                    "caption": caption,
//                            "subCaption": "In MMbbl = One Million barrels",
                                    "xAxisName": xaxisname,
                                    "yAxisName": "Amount (In Naira)",
                                    "numberSuffix": "",
                                    "theme": "fusion",
                                },
                                "data": d
                            }
                        };
                        $('#interest-demo-chart').show();
                        $("#interest-demo-chart").insertFusionCharts(interestConfigs);
                    },
                    'error': function (err) {
                        return swal('Error in Connection!','','error')
                    }
                });
        }
        if (report === 'Bad Loans'){
            let d = [];
            url = `user/demographic-badloans-report?trend=${report}&&filter=${filter}&&period=${period}&&year=${year.value}`,
                $.ajax({
                    'url': url,
                    'type': 'get',
                    'success': function (data) {
                        bd = data.message.badloans;
                        jQuery.each(bd, function(k, v){
                            if (v.gender){
                                d.push({label: v.gender , value: v.amount}, );
                                caption = 'Badloans by Gender';
                                xaxisname = 'Gender';
                            }
                            if (v.dob){
                                d.push({label: v.age_range, value: v.amount}, );
                                caption = 'Badloans by Age Groups';
                                xaxisname = 'Age Groups';
                            }
                        });
                        var badloanConfigs = {
                            type: 'column2d', // The chart type
                            width: '100%', // Width of the chart
                            height: '400', // Height of the chart
                            dataFormat: 'json', // Data type
                            dataSource: {
                                "chart": {
                                    "caption": caption,
//                            "subCaption": "In MMbbl = One Million barrels",
                                    "xAxisName": xaxisname,
                                    "yAxisName": "Amount (In Naira)",
                                    "numberSuffix": "",
                                    "theme": "fusion",
                                },
                                "data": d
                            }
                        };
                        $('#badloan-demo-chart').show();
                        $("#badloan-demo-chart").insertFusionCharts(badloanConfigs);
                    },
                    'error': function (err) {
                        return swal('Error in Connection!','','error')
                    }
                });
        }
        if (report === 'Overdue Loans'){
            let d = [];
            url = `user/demographic-overdues-report?trend=${report}&&filter=${filter}&&period=${period}&&year=${year.value}`,
                $.ajax({
                    'url': url,
                    'type': 'get',
                    'success': function (data) {
                        od = data.message.overdues;
                        jQuery.each(od, function(k, v){
                            if (v.gender){
                                d.push({label: v.gender , value: v.amount}, );
                                caption = 'Overdue Loans by Gender';
                                xaxisname = 'Gender';
                            }
                            if (v.dob){
                                d.push({label: v.age_range, value: v.amount}, );
                                caption = 'Overdue Loans by Age Groups';
                                xaxisname = 'Age Groups';
                            }
                        });
                        var overdueConfigs = {
                            type: 'column2d', // The chart type
                            width: '100%', // Width of the chart
                            height: '400', // Height of the chart
                            dataFormat: 'json', // Data type
                            dataSource: {
                                "chart": {
                                    "caption": caption,
//                            "subCaption": "In MMbbl = One Million barrels",
                                    "xAxisName": xaxisname,
                                    "yAxisName": "Amount (In Naira)",
                                    "numberSuffix": "",
                                    "theme": "fusion",
                                },
                                "data": d
                            }
                        };
                        $('#overdue-demo-chart').show();
                        $("#overdue-demo-chart").insertFusionCharts(overdueConfigs);
                    },
                    'error': function (err) {
                        return swal('Error in Connection!','','error')
                    }
                });
        }
    }

    function loadIndividualBorrowersReport(){
        let url = 'user/individual-borrowers'
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                if (data.status === 200){
                    $("#ind-bor").excelexportjs({
                        containerid: "dvjson",
                        datatype: 'json',
                        dataset: data.response,
                        worksheetName: "Individual Borrowers",
                        columns: getColumns(data.response)
                    });
                }
                else {
                    return swal({
                        "icon": "error",
                        "text": 'Database Error'
                    });
                }
            },
            'error': function (err) {
                swal('Error in Connection!', '', 'error')
            }
        });
    }

    function loadCorporateBorrowersReport(){
        let url = 'user/corporate-borrowers'
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                if (data.status === 200){
                    $("#corp-bor").excelexportjs({
                        containerid: "dvjson",
                        datatype: 'json',
                        dataset: data.response,
                        worksheetName: "Corporate Borrowers",
                        columns: getColumns(data.response)
                    });
                }
                else {
                    return swal({
                        "icon": "error",
                        "text": 'Database Error'
                    });
                }
            },
            'error': function (err) {
                swal('Error in Connection!', '', 'error')
            }
        });
    }

    function loadPrincipalOfficersReport(){
        let url = 'user/principal-officers'
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                if (data.status === 200){
                    $("#prin-off").excelexportjs({
                        containerid: "dvjson",
                        datatype: 'json',
                        dataset: data.response,
                        worksheetName: "Principal Officers",
                        columns: getColumns(data.response)
                    });
                }
                else {
                    return swal({
                        "icon": "error",
                        "text": 'Database Error'
                    });
                }
            },
            'error': function (err) {
                swal('Error in Connection!', '', 'error')
            }
        });
    }

    function loadCreditInformationReport(){
        let url = 'user/credit-information'
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                if (data.status === 200){
                    $("#cred-info").excelexportjs({
                        containerid: "dvjson",
                        datatype: 'json',
                        dataset: data.response,
                        worksheetName: "Credit Information",
                        columns: getColumns(data.response)
                    });
                }
                else {
                    return swal({
                        "icon": "error",
                        "text": 'Database Error'
                    });
                }
            },
            'error': function (err) {
                swal('Error in Connection!', '', 'error')
            }
        });
    }

    function loadGuarantorsInformationReport(){
        let url = 'user/guarantors-information'
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                if (data.status === 200){
                    $("#gua-info").excelexportjs({
                        containerid: "dvjson",
                        datatype: 'json',
                        dataset: data.response,
                        worksheetName: "Guarantors Information",
                        columns: getColumns(data.response)
                    });
                }
                else {
                    return swal({
                        "icon": "error",
                        "text": 'Database Error'
                    });
                }
            },
            'error': function (err) {
                swal('Error in Connection!', '', 'error')
            }
        });
    }

    function loadPortfolioLoanRiskReport(){
        let url = 'user/portfolio-loan-risk'
        $.ajax({
            'url': url,
            'type': 'get',
            'success': function (data) {
                if (data.status === 200){
                    $("#pf-lr").excelexportjs({
                        containerid: "dvjson",
                        datatype: 'json',
                        dataset: data.response,
                        worksheetName: "Portfolio Loan Risk",
                        columns: getColumns(data.response)
                    });
                }
                else {
                    return swal({
                        "icon": "error",
                        "text": 'Database Error'
                    });
                }
            },
            'error': function (err) {
                swal('Error in Connection!', '', 'error')
            }
        });
    }

</script>

</body>
</html>
